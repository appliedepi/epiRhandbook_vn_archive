<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 R Cơ bản | Cẩm nang dịch tễ học với R</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.16/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.0.0/tabwid.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.2.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.52.2/plotly-basic-1.52.2.min.js"></script><script src="libs/plotly-cartesian-1.52.2/plotly-cartesian-1.52.2.min.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Cẩm nang dịch tễ học với R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">Về cuốn sách này</li>
<li><a class="" href="editorial-style.html"><span class="header-section-number">1</span> Biên tập và ghi chú kỹ thuật</a></li>
<li><a class="" href="data-used.html"><span class="header-section-number">2</span> Tải sách và dữ liệu</a></li>
<li class="book-part">Nhập môn về R</li>
<li><a class="active" href="basics.html"><span class="header-section-number">3</span> R Cơ bản</a></li>
<li><a class="" href="transition-to-R.html"><span class="header-section-number">4</span> Chuyển đổi sang R</a></li>
<li><a class="" href="packages-suggested.html"><span class="header-section-number">5</span> Package đề xuất</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> Dự án R</a></li>
<li><a class="" href="importing.html"><span class="header-section-number">7</span> Nhập xuất dữ liệu</a></li>
<li class="book-part">Quản lý dữ liệu</li>
<li><a class="" href="cleaning.html"><span class="header-section-number">8</span> Làm sạch số liệu và các hàm quan trọng</a></li>
<li><a class="" href="dates.html"><span class="header-section-number">9</span> Làm việc với ngày tháng</a></li>
<li><a class="" href="characters-strings.html"><span class="header-section-number">10</span> Ký tự và chuỗi</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">11</span> Factors</a></li>
<li><a class="" href="pivoting.html"><span class="header-section-number">12</span> Xoay trục dữ liệu</a></li>
<li><a class="" href="grouping.html"><span class="header-section-number">13</span> Nhóm dữ liệu</a></li>
<li><a class="" href="joining-matching.html"><span class="header-section-number">14</span> Nối dữ liệu</a></li>
<li><a class="" href="deduplication.html"><span class="header-section-number">15</span> Loại bỏ trùng lặp</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">16</span> Lặp, vòng lặp, và danh sách</a></li>
<li class="book-part">Phân tích dữ liệu</li>
<li><a class="" href="tables-descriptive.html"><span class="header-section-number">17</span> Bảng mô tả</a></li>
<li><a class="" href="stat-tests.html"><span class="header-section-number">18</span> Các kiểm định thống kê cơ bản</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">19</span> Hồi quy đơn và đa biến</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Dữ liệu Missing</a></li>
<li><a class="" href="standardization.html"><span class="header-section-number">21</span> Tỷ suất chuẩn hóa</a></li>
<li><a class="" href="moving-average.html"><span class="header-section-number">22</span> Đường trung bình động</a></li>
<li><a class="" href="time-series.html"><span class="header-section-number">23</span> Chuỗi thời gian và phát hiện ổ dịch</a></li>
<li><a class="" href="epidemic-models.html"><span class="header-section-number">24</span> Mô hình hóa dịch bệnh</a></li>
<li><a class="" href="contact-tracing.html"><span class="header-section-number">25</span> Truy vết tiếp xúc</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">26</span> Phân tích khảo sát</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">27</span> Phân tích sống còn</a></li>
<li><a class="" href="gis.html"><span class="header-section-number">28</span> GIS cơ bản</a></li>
<li class="book-part">Trực quan hóa dữ liệu</li>
<li><a class="" href="tables-presentation.html"><span class="header-section-number">29</span> Trình bày bảng</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">30</span> ggplot cơ bản</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">31</span> Các tips với ggplot</a></li>
<li><a class="" href="epicurves.html"><span class="header-section-number">32</span> Đường cong dịch bệnh</a></li>
<li><a class="" href="age-pyramid.html"><span class="header-section-number">33</span> Tháp dân số và thang đo Likert</a></li>
<li><a class="" href="heatmaps.html"><span class="header-section-number">34</span> Biểu đồ nhiệt</a></li>
<li><a class="" href="diagrams.html"><span class="header-section-number">35</span> Sơ đồ và biểu đồ</a></li>
<li><a class="" href="combination-analysis.html"><span class="header-section-number">36</span> Biểu đồ kết hợp</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">37</span> Chuỗi lây nhiễm</a></li>
<li><a class="" href="phylogenetic-trees.html"><span class="header-section-number">38</span> Cây phả hệ</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">39</span> Biểu đồ tương tác</a></li>
<li class="book-part">Báo cáo và dashboards</li>
<li><a class="" href="rmarkdown.html"><span class="header-section-number">40</span> Báo cáo với R Markdown</a></li>
<li><a class="" href="reportfactory.html"><span class="header-section-number">41</span> Tổ chức báo cáo định kỳ</a></li>
<li><a class="" href="flexdashboard.html"><span class="header-section-number">42</span> Dashboards với R Markdown</a></li>
<li><a class="" href="shiny-basics.html"><span class="header-section-number">43</span> Dashboards với Shiny</a></li>
<li class="book-part">Tổng hợp</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">44</span> Viết hàm</a></li>
<li><a class="" href="directories.html"><span class="header-section-number">45</span> Tương tác với thư mục làm việc</a></li>
<li><a class="" href="collaboration.html"><span class="header-section-number">46</span> Version control với Git và Github</a></li>
<li><a class="" href="errors.html"><span class="header-section-number">47</span> Các lỗi thường gặp</a></li>
<li><a class="" href="help.html"><span class="header-section-number">48</span> Nhờ sự trợ giúp</a></li>
<li><a class="" href="network-drives.html"><span class="header-section-number">49</span> R trên ổ cứng mạng</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">50</span> Data Table</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basics" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> R Cơ bản<a class="anchor" aria-label="anchor" href="#basics"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/basics_header_close.png" width="100%" style="display: block; margin: auto;"></div>
<p>Chào mừng bạn!</p>
<p>Chương này sẽ mô tả những kỹ thuật cơ bản của R. Đây không phải là hướng dẫn sử dụng toàn diện, nhưng sẽ cung cấp những kiến thức cơ bản và có thể hữu ích trong việc làm mới hiểu biết của bạn. Phần <a href="basics.html#learning">Tài nguyên học liệu</a> sẽ liên kết đến những hướng dẫn sử dụng R bao quát hơn.</p>
<p>Các phần của chương này đã được điều chỉnh dưới sự cho phép của <a href="https://r4epis.netlify.app/">Dự án R4Epis</a>.</p>
<p>Xem chương <a href="transition-to-R.html#transition-to-R">Chuyển đổi sang R</a> để biết các mẹo khi chuyển đổi từ STATA, SAS hoặc Excel sang R.</p>
<!-- ======================================================= -->
<div id="tại-sao-sử-dụng-r" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Tại sao sử dụng R?<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1i-sao-s%E1%BB%AD-d%E1%BB%A5ng-r"><i class="fas fa-link"></i></a>
</h2>
<p>Như đã được công bố trên <a href="https://www.r-project.org/about.html">trang web dự án R</a>, R là một ngôn ngữ và môi trường lập trình cho tính toán và đồ họa thống kê. Nó rất linh hoạt, có khả năng mở rộng và hướng tới cộng đồng.</p>
<p><strong>Chi phí</strong></p>
<p>R được sử dụng miễn phí! Có sự tồn tại mạnh mẽ về đạo đức trong cộng đồng người sử dụng nguồn tài nguyên mở và miễn phí.</p>
<p><strong>Khả năng tái lập</strong></p>
<p>Thực hiện quản lý và phân tích dữ liệu của bạn thông qua một ngôn ngữ lập trình (so sánh với Excel hoặc công cụ khác mà thao tác chính là nhấp chuột/thao tác thủ công) giúp nâng cao <strong>khả năng tái lập</strong>, giúp <strong>phát hiện lỗi</strong> dễ dàng hơn và giảm bớt khối lượng công việc của bạn.</p>
<p><strong>Cộng đồng</strong></p>
<p>R có cộng đồng người dùng khổng lồ và có tính hợp tác. Các package và công cụ mới nhằm giải quyết các vấn đề thực tế được phát triển hàng ngày và được kiểm tra bởi cộng đồng người dùng. Ví dụ, <a href="https://rladies.org/">R-Ladies</a> là một tổ chức toàn cầu có sứ mệnh thúc đẩy sự đa dạng giới trong cộng đồng R và là một trong những tổ chức người dùng R lớn nhất. Thậm chí có thể có một phần của nhóm này đang ở gần bạn!</p>
</div>
<div id="các-thuật-ngữ-chính" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Các thuật ngữ chính<a class="anchor" aria-label="anchor" href="#c%C3%A1c-thu%E1%BA%ADt-ng%E1%BB%AF-ch%C3%ADnh"><i class="fas fa-link"></i></a>
</h2>
<p><strong>RStudio</strong> - RStudio là Giao diện đồ họa người dùng (GUI) giúp sử dụng <strong>R</strong> dễ dàng hơn. Đọc thêm <a href="basics.html#rstudio">trong mục RStudio</a>.</p>
<p><strong>Đối tượng</strong> - Bao gồm mọi thứ bạn lưu trữ trong R - bộ dữ liệu, biến, danh sách tên làng, quy mô dân số, thậm chí cả các kết quả đầu ra như đồ thị - là các <em>đối tượng</em> được <em>gán tên</em> và <em>có thể được tham chiếu</em> trong các lệnh sau này. Đọc thêm <a href="basics.html#objects">trong mục Đối tượng</a>.</p>
<p><strong>Hàm</strong> - Mỗi hàm là một code hoạt động mà chấp nhận dữ liệu đầu vào và trả về kết quả đầu ra đã được biến đổi. Đọc thêm <a href="basics.html#functions">trong mục Các hàm</a>.</p>
<p><strong>Packages</strong> - Mỗi package R là một gói câu lệnh có khả năng chia sẻ. Đọc thêm <a href="basics.html#packages">trong mục Packages</a>.</p>
<p><strong>Scripts</strong> - Mỗi script là một tệp tài liệu chứa các lệnh của bạn. Đọc thêm <a href="basics.html#scripts">trong mục Scripts</a></p>
</div>
<div id="learning" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Tài nguyên học liệu<a class="anchor" aria-label="anchor" href="#learning"><i class="fas fa-link"></i></a>
</h2>
<div id="tài-nguyên-trong-rstudio" class="section level3 unnumbered">
<h3>Tài nguyên trong RStudio<a class="anchor" aria-label="anchor" href="#t%C3%A0i-nguy%C3%AAn-trong-rstudio"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Tài liệu trợ giúp</strong></p>
<p>Tìm kiếm tab “Help” của RStudio về tài liệu liên quan đến package R và các hàm cụ thể. Tab này nằm trong cửa sổ chứa các tab Files, Plots và Packages (thường ở cửa sổ phía dưới bên phải). Như một lối tắt, bạn cũng có thể nhập tên của một package hoặc câu lệnh vào R Console sau dấu hỏi chấm và không bao gồm dấu ngoặc đơn để mở trang trợ giúp liên quan.</p>
<p>Ví dụ: <code><a href="https://rdrr.io/r/stats/filter.html">?filter</a></code> hoặc <code>?diagrammeR</code>.</p>
<p><strong>Các hướng dẫn có sự tương tác</strong></p>
<p>R có thể được học thông qua một số tương tác <em>trong</em> RStudio.</p>
<p>RStudio cung cấp một cửa sổ Tutorial được hỗ trợ bởi package <a href="https://blog.rstudio.com/2020/02/25/rstudio-1-3-integrated-tutorials/"><strong>learnr</strong></a>. Chỉ cần cài đặt package này và mở hướng dẫn qua tab “Tutorial” trong cửa sổ RStudio phía trên bên phải (cũng chứa các tab Environment và History).</p>
<p>Package <a href="https://swirlstats.com/"><strong>swirl</strong></a> cung cấp các nội dung học tương tác trong R Console. Cài đặt và tải package này, rồi chạy lệnh <code>swirl()</code> (dấu ngoặc đơn trống) trong R Console. Bạn sẽ thấy các thông báo xuất hiện trong cửa sổ Console. Phản hồi bằng cách nhập vào Console. Nó sẽ hướng dẫn bạn qua một nội dung học do bạn lựa chọn.</p>
</div>
<div id="cheatsheets" class="section level3 unnumbered">
<h3>Cheatsheets<a class="anchor" aria-label="anchor" href="#cheatsheets"><i class="fas fa-link"></i></a>
</h3>
<p>Có rất nhiều “cheatsheets” PDF có sẵn trên <a href="https://rstudio.com/resources/cheatsheets/">trang web của RStudio</a>, ví dụ như:</p>
<ul>
<li>Factors với package <strong>forcats</strong><br>
</li>
<li>Ngày và thời gian với package <strong>lubridate</strong><br>
</li>
<li>Chuỗi với package <strong>stringr</strong><br>
</li>
<li>Các vòng lặp với package <strong>purrr</strong><br>
</li>
<li>Nhập dữ liệu<br>
</li>
<li>Cheatsheet biến đổi dữ liệu với package <strong>dplyr</strong><br>
</li>
<li>R Markdown (để tạo các tài liệu như PDF, Word, Powerpoint…)<br>
</li>
<li>Shiny (để xây dựng các ứng dụng web tương tác)<br>
</li>
<li>Trực quan hóa dữ liệu với package <strong>ggplot2</strong><br>
</li>
<li>Bản đồ học (GIS)<br>
</li>
<li>Package <strong>leaflet</strong> (bản đồ tương tác)<br>
</li>
<li>Python với R (package <strong>reticulate</strong>)</li>
</ul>
<p>Đây là tài nguyên R trực tuyến dành riêng cho <a href="https://jules32.github.io/r-for-excel-users/">Người dùng Excel</a></p>
</div>
<div id="twitter" class="section level3 unnumbered">
<h3>Twitter<a class="anchor" aria-label="anchor" href="#twitter"><i class="fas fa-link"></i></a>
</h3>
<p>R có một cộng đồng twitter sôi động, nơi bạn có thể tìm hiểu các mẹo, lối tắt và tin tức - hãy theo dõi các tài khoản sau:</p>
<ul>
<li>Theo dõi chúng tôi: <a href="https://twitter.com/epirhandbook">@epiRhandbook</a><br>
</li>
<li>R Function A Day <a href="https://twitter.com/rfunctionaday">@rfuntionaday</a> là một nguồn tài nguyên <em>tuyệt vời</em>
</li>
<li>R for Data Science <a href="https://twitter.com/rstats4ds?lang=en">@rstats4ds</a><br>
</li>
<li>RStudio <a href="https://twitter.com/rstudio?lang=en">@RStudio</a><br>
</li>
<li>RStudio Tips <a href="https://twitter.com/rstudiotips">@rstudiotips</a><br>
</li>
<li>R-Bloggers <a href="https://twitter.com/Rbloggers">@Rbloggers</a><br>
</li>
<li>R-ladies <a href="https://twitter.com/RLadiesGlobal">@RLadiesGlobal</a><br>
</li>
<li>Hadley Wickham <a href="https://twitter.com/hadleywickham?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">@hadleywickham</a>
</li>
</ul>
<p>Cũng như:</p>
<p><strong>#epitwitter</strong> và <strong>#rstats</strong></p>
</div>
<div id="nguồn-tài-nguyên-trực-tuyến-miễn-phí" class="section level3 unnumbered">
<h3>Nguồn tài nguyên trực tuyến miễn phí<a class="anchor" aria-label="anchor" href="#ngu%E1%BB%93n-t%C3%A0i-nguy%C3%AAn-tr%E1%BB%B1c-tuy%E1%BA%BFn-mi%E1%BB%85n-ph%C3%AD"><i class="fas fa-link"></i></a>
</h3>
<p>Cuốn sách <a href="https://r4ds.had.co.nz/">R for Data Science</a> (R dành cho Khoa học Dữ liệu) của Garrett Grolemund và Hadley Wickham</p>
<p>Trang web của dự án <a href="https://r4epis.netlify.app/">R4Epis</a> nhằm mục đích “phát triển các công cụ làm sạch, phân tích và báo cáo dữ liệu được chuẩn hóa dùng trong các trường hợp bùng phát dịch phổ biến và các cuộc điều tra dựa trên dân số mà sẽ được tiến hành trong các ứng phó khẩn cấp của Tổ chức Bác sỹ không biên giới” Bạn có thể tìm thấy tài liệu đào tạo cơ bản về R, các mẫu báo cáo RMarkdown và khảo sát về các đợt bùng phát dịch, cũng như các hướng dẫn để giúp bạn thiết lập chúng.</p>
</div>
<div id="các-ngôn-ngữ-khác-ngoài-tiếng-anh" class="section level3 unnumbered">
<h3>Các ngôn ngữ khác ngoài Tiếng Anh<a class="anchor" aria-label="anchor" href="#c%C3%A1c-ng%C3%B4n-ng%E1%BB%AF-kh%C3%A1c-ngo%C3%A0i-ti%E1%BA%BFng-anh"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://www.rstudio.com/collections/espanol/">Tài liệu RStudio bằng tiếng Tây Ban Nha</a></p>
<p><a href="https://juba.github.io/tidyverse/index.html">Giới thiệu cơ bản về R (tiếng Pháp)</a></p>
<!-- ======================================================= -->
</div>
</div>
<div id="cài-đặt" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Cài đặt<a class="anchor" aria-label="anchor" href="#c%C3%A0i-%C4%91%E1%BA%B7t"><i class="fas fa-link"></i></a>
</h2>
<div id="r-và-rstudio" class="section level3 unnumbered">
<h3>R và RStudio<a class="anchor" aria-label="anchor" href="#r-v%C3%A0-rstudio"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Làm thế nào để cài đặt R</strong></p>
<p>Truy cập vào trang web <a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a> và tải phiên bản mới nhất của R phù hợp với máy tính của bạn.</p>
<p><strong>Làm thế nào để cài đặt RStudio</strong></p>
<p>Truy cập vào trang web <a href="https://rstudio.com/products/rstudio/download/" class="uri">https://rstudio.com/products/rstudio/download/</a> và tải phiên bản Desktop mới nhất của RStudio phù hợp với máy tính của bạn.</p>
<p><strong>Quyền truy cập</strong><br>
Lưu ý rằng bạn nên cài đặt R và RStudio vào một ổ đĩa mà bạn có quyền đọc và ghi lại. Nếu không, khả năng cài đặt các package R (thường xuyên xảy ra) của bạn sẽ bị ảnh hưởng. Nếu bạn gặp sự cố, hãy thử mở RStudio bằng cách nhấp chuột phải vào biểu tượng và chọn “Run as administrator”. Các mẹo khác có thể được tìm thấy trong chương <a href="network-drives.html#network-drives">R trên ổ cứng mạng</a>.</p>
<p><strong>Làm thế nào để cập nhật R và RStudio</strong></p>
<p>Phiên bản R của bạn được in ra R Console khi khởi động. Bạn cũng có thể chạy lệnh <code><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo()</a></code>.</p>
<p>Để cập nhật R, truy cập đến trang web được nhắc đến ở trên và cài đặt lại R. Ngoài ra, bạn có thể sử dụng package <strong>installr</strong> (trên Windows) bằng cách chạy câu lệnh <code><a href="http://talgalili.github.io/installr/reference/updateR.html">installr::updateR()</a></code>. Thao tác này sẽ mở ra các hộp thoại giúp bạn tải xuống phiên bản R mới nhất và cập nhật các package của bạn lên phiên bản R mới. Có thể tìm thấy thêm chi tiết trong <a href="https://www.r-project.org/nosvn/pandoc/installr.html">tài liệu</a> <strong>installr</strong> .</p>
<p>Lưu ý rằng phiên bản R cũ sẽ vẫn tồn tại trong máy tính của bạn. Bạn có thể tạm thời chạy phiên bản cũ hơn (“installation” cũ hơn) của R bằng cách nhấp vào “Tools” -&gt; “Global Options” trong RStudio và chọn một phiên bản R. Điều này có thể hữu ích nếu bạn muốn sử dụng một package chưa được cập nhật để hoạt động trên phiên bản R mới nhất.</p>
<p>Để cập nhật RStudio, truy cập đến trang web được nhắc đến ở trên và cài đặt lại RStudio. Một tùy chọn khác là nhấp vào “Help” -&gt; “Check for Updates” trong RStudio, nhưng điều này có thể dẫn đến việc không hiển thị các bản cập nhật mới nhất.</p>
<p>Để xem phiên bản R, RStudio hoặc package nào đã được sử dụng khi viết Sổ tay này, hãy xem chương <a href="editorial-style.html#editorial-style">Biên tập và ghi chú kỹ thuật</a>.</p>
</div>
<div id="những-phần-mềm-khác-bạn-có-thể-cần-cài-đặt" class="section level3 unnumbered">
<h3>Những phần mềm khác bạn <em>có thể</em> cần cài đặt<a class="anchor" aria-label="anchor" href="#nh%E1%BB%AFng-ph%E1%BA%A7n-m%E1%BB%81m-kh%C3%A1c-b%E1%BA%A1n-c%C3%B3-th%E1%BB%83-c%E1%BA%A7n-c%C3%A0i-%C4%91%E1%BA%B7t"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>TinyTeX (<em>để biên dịch tài liệu RMarkdown sang PDF</em>)<br>
</li>
<li>Pandoc (<em>để biên dịch tài liệu RMarkdown</em>)<br>
</li>
<li>RTools (<em>để xây dựng các package cho R</em>)<br>
</li>
<li>phantomjs (<em>để lưu ảnh tĩnh của mạng động, chẳng hạn như chuỗi lây truyền</em>)</li>
</ul>
<div id="tinytex" class="section level4 unnumbered">
<h4>TinyTex<a class="anchor" aria-label="anchor" href="#tinytex"><i class="fas fa-link"></i></a>
</h4>
<p>TinyTex là một bản phân phối LaTeX tùy chỉnh, hữu ích khi tạo các tệp PDF từ R.<br>
Truy cập <a href="https://yihui.org/tinytex/" class="uri">https://yihui.org/tinytex/</a> để tìm hiểu thêm thông tin.</p>
<p>Để cài đặt TinyTex từ R:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'tinytex'</span><span class="op">)</span>
<span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/install_tinytex.html">install_tinytex</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># to uninstall TinyTeX, run tinytex::uninstall_tinytex()</span></code></pre></div>
</div>
<div id="pandoc" class="section level4 unnumbered">
<h4>Pandoc<a class="anchor" aria-label="anchor" href="#pandoc"><i class="fas fa-link"></i></a>
</h4>
<p>Pandoc là một công cụ chuyển đổi văn bản, một phần mềm tách biệt với R. <strong>Nó đi kèm với RStudio và không cần phải tải xuống.</strong> Nó hỗ trợ quá trình chuyển đổi văn bản từ Rmarkdown sang các định dạng như .pdf và có bổ sung thêm một số tính năng phức tạp.</p>
</div>
<div id="rtools" class="section level4 unnumbered">
<h4>RTools<a class="anchor" aria-label="anchor" href="#rtools"><i class="fas fa-link"></i></a>
</h4>
<p>RTools là một phần mềm được sử dụng để xây dựng package cho R</p>
<p>Cài đặt từ trang web: <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a></p>
</div>
<div id="phantomjs" class="section level4 unnumbered">
<h4>phantomjs<a class="anchor" aria-label="anchor" href="#phantomjs"><i class="fas fa-link"></i></a>
</h4>
<p>Phần mềm này thường được sử dụng để chụp “chụp ảnh màn hình” trang web. Ví dụ khi bạn tạo một chuỗi lây truyền với package <strong>epicontacts</strong>, một tệp HTML có thể tương tác và chuyển động được tạo ra. Nếu bạn muốn có hình ảnh tĩnh, sử dụng package <a href="https://wch.github.io/webshot/articles/intro.html"><strong>webshot</strong></a> để tự động hóa quá trình này. Việc này sẽ yêu cầu chương trình bên ngoài “phantomjs”. Bạn có thể cài đặt phantomjs thông qua package <strong>webshot</strong> bằng lệnh <code><a href="https://rdrr.io/pkg/webshot/man/install_phantomjs.html">webshot::install_phantomjs()</a></code>.</p>
<!-- ======================================================= -->
</div>
</div>
</div>
<div id="rstudio" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> RStudio<a class="anchor" aria-label="anchor" href="#rstudio"><i class="fas fa-link"></i></a>
</h2>
<div id="làm-quen" class="section level3 unnumbered">
<h3>Làm quen<a class="anchor" aria-label="anchor" href="#l%C3%A0m-quen"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Đầu tiên, mở RStudio.</strong> Biểu tượng của chúng có sự tương đồng, hãy chắc chắn bạn đang mở <em>RStudio</em> chứ không phải R.</p>
<p>Để RStudio hoạt động bạn cũng cần phải cài đặt R trên máy tính (xem hướng dẫn cài đặt ở bên trên).</p>
<p><strong>RStudio</strong> là một giao diện người dùng (GUI) giúp sử dụng <strong>R</strong> dễ dàng hơn. YBạn có thể coi R như một động cơ đang đảm đương công việc chính của một phương tiện và RStudio là phần thân của phương tiện (với ghế ngồi, các phụ kiện,…) giúp bạn sử dụng động cơ tiến về phía trước. Bạn có thể xem toàn bộ cheatsheet giao diện người dùng của RStudio (PDF) tại <a href="https://www.rstudio.com/wp-content/uploads/2016/01/rstudio-IDE-cheatsheet.pdf">đây</a></p>
<p>RStudio mặc định hiển thị bốn cửa sổ hình chữ nhật.</p>
<div class="inline-figure"><img src="images/RStudio_overview.PNG" width="100%" style="display: block; margin: auto;"></div>
<p><span style="color: black;"><strong><em>MẸO:</em></strong> Nếu RStudio của bạn chỉ hiển thị một cửa sổ bên trái thì đó là do bạn chưa mở scripts nào.</span></p>
<p><strong>Cửa sổ mã nguồn</strong><br>
Cửa sổ này, mặc định hiển thị phía trên bên trái, là một khoảng trống để chỉnh sửa, chạy và lưu các <a href="basics.html#scripts">scripts</a> của bạn. Script chứa các lệnh mà bạn muốn chạy. Cửa sổ này cũng có thể hiển thị thông tin dữ liệu (data frames).</p>
<p>Đối với người dùng Stata, cửa sổ này tương tự với các cửa sổ Do-file và Data Editor.</p>
<p><strong>Cửa sổ R Console</strong></p>
<p>R Console, mặc định ở cửa sổ bên trái hoặc phía dưới bên trái của RStudio, là ngôi nhà của “động cơ” R. Đây là nơi các lệnh thực sự được chạy, các kết quả đầu ra không phải là đồ họa và các thông báo lỗi/cảnh báo sẽ xuất hiện. Bạn có thể nhập và chạy các lệnh trực tiếp trong R Console, nhưng sẽ sớm nhận ra các lệnh này không được lưu như khi chạy lệnh từ một script.</p>
<p>Nếu bạn đã quen thuộc với Stata, R Console giống như cửa sổ Command Window và Results Window.</p>
<p><strong>Cửa sổ Environment</strong><br>
Cửa sổ này, mặc định ở phía trên bên phải, thường được sử dụng để xem tóm tắt ngắn gọn về các <a href="basics.html#objects">đối tượng</a> itrong R Environment ở phiên hiện tại. Các đối tượng này có thể bao gồm các tập dữ liệu đã được nhập, chỉnh sửa hoặc tạo mới, các tham số bạn đã xác định (ví dụ: một tuần dịch tễ cụ thể để phân tích), vectơ hoặc các danh sách bạn đã xác định trong quá trình phân tích (ví dụ: tên các vùng). Bạn có thể nhấp vào mũi tên bên cạnh tên của data frames để xem các biến số của nó.</p>
<p>Cửa sổ này gần giống với cửa sổ Variables Manager trong Stata.</p>
<p>Cửa sổ này cũng chứa <em>History</em> - nơi mà bạn có thể xem các lệnh đã làm trước đó. Nó cũng có một tab “Tutorial” - là nơi mà bạn có thể hoàn thành các hướng dẫn tương tác với R nếu bạn đã cài đặt package <strong>learnr</strong>. Nó cũng chứa một tab “Connections” cho phép các kết nối bên ngoài và có thể có cửa sổ “Git” nếu bạn chọn giao diện với Github.</p>
<p><strong>Cửa sổ Plots, Viewer, Packages, và Help</strong><br>
Cửa sổ phía dưới bên phải bao gồm một số tab quan trọng. Các đồ họa chính điển hình bao gồm bản đồ sẽ được hiển thị trong Cửa sổ Plot. Các kết quả đầu ra tương tác hoặc HTML sẽ được hiển thị trong cửa sổ Viewer. Cửa sổ File là một trình duyệt có thể được sử dụng để mở hoặc xóa tệp. Cửa sổ Packages cho phép bạn xem, cài đặt, cập nhật, xóa, tải/dỡ các package R và xem bạn có phiên bản package nào. Để tìm hiểu thêm về các package hãy xem <a href="basics.html#packages">mục packages</a> bên dưới.</p>
<p>Cửa sổ này chứa các nội dung tương đương với các cửa sổ Plots Manager và Project Manager trong Stata.</p>
</div>
<div id="các-cài-đặt-của-rstudio" class="section level3 unnumbered">
<h3>Các cài đặt của RStudio<a class="anchor" aria-label="anchor" href="#c%C3%A1c-c%C3%A0i-%C4%91%E1%BA%B7t-c%E1%BB%A7a-rstudio"><i class="fas fa-link"></i></a>
</h3>
<p>Thay đổi các cài đặt và giao diện của RStudio trong thanh menu thả xuống <em>Tools</em>, bằng cách chọn <em>Global Options</em>. Ở đó, bạn có thể thay đổi cài đặt mặc định, bao gồm cả màu giao diện/nền.</p>
<p><img src="images/RStudio_tools_options_1.png" width="50%"><img src="images/RStudio_tools_options.png" width="50%"></p>
<p><strong>Khởi động lại</strong></p>
<p>Nếu R của bạn bị treo, bạn có thể khởi động lại R bằng cách di chuột đến menu Session và nhấp vào “Restart R”. Thao tác này giúp tránh rắc rối khi đóng và mở RStudio. Mọi thứ trong môi trường R của bạn sẽ bị xóa khi thực hiện thao tác này.</p>
</div>
<div id="các-phím-tắt" class="section level3 unnumbered">
<h3>Các phím tắt<a class="anchor" aria-label="anchor" href="#c%C3%A1c-ph%C3%ADm-t%E1%BA%AFt"><i class="fas fa-link"></i></a>
</h3>
<p>Dưới đây là một vài phím tắt rất hữu dụng. Tất cả các phím tắt cho Windows, Max và Linux nằm ở chương 2 <a href="https://www.rstudio.com/wp-content/uploads/2016/01/rstudio-IDE-cheatsheet.pdf">cheatsheet giao diện người dùng</a> của RStudio.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="17%">
<col width="12%">
<col width="69%">
</colgroup>
<thead><tr class="header">
<th>Windows/Linux</th>
<th>Mac</th>
<th>Hành động</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Esc</td>
<td>Esc</td>
<td>Ngắt lệnh hiện tại (hữu ích nếu bạn vô tình chạy một lệnh chưa hoàn chỉnh và không thể thoát khỏi việc nhìn thấy “+” trong R console)</td>
</tr>
<tr class="even">
<td>Ctrl+s</td>
<td>Cmd+s</td>
<td>Lưu (script)</td>
</tr>
<tr class="odd">
<td>Tab</td>
<td>Tab</td>
<td>Tự động điền</td>
</tr>
<tr class="even">
<td>Ctrl + Enter</td>
<td>Cmd + Enter</td>
<td>Chạy (các) dòng/phần code đang được chọn</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + C</td>
<td>Cmd + Shift + c</td>
<td>Bình luận/bỏ bình luận các dòng được đánh dấu</td>
</tr>
<tr class="even">
<td>Alt + -</td>
<td>Option + -</td>
<td>Chèn <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>
</td>
</tr>
<tr class="odd">
<td>Ctrl + Shift + m</td>
<td>Cmd + Shift + m</td>
<td>Chèn <code>%&gt;%</code>
</td>
</tr>
<tr class="even">
<td>Ctrl + l</td>
<td>Cmd + l</td>
<td>Dọn dẹp R console</td>
</tr>
<tr class="odd">
<td>Ctrl + Alt + b</td>
<td>Cmd + Option + b</td>
<td>Chạy từ đầu đến dòng hiện tại</td>
</tr>
<tr class="even">
<td>Ctrl + Alt + t</td>
<td>Cmd + Option + t</td>
<td>Chạy code chunk hiện tại (R Markdown)</td>
</tr>
<tr class="odd">
<td>Ctrl + Alt + i</td>
<td>Cmd + Shift + r</td>
<td>Chèn code chunk (vào R Markdown)</td>
</tr>
<tr class="even">
<td>Ctrl + Alt + c</td>
<td>Cmd + Option + c</td>
<td>Chạy code chunk hiện tại (R Markdown)</td>
</tr>
<tr class="odd">
<td>up/down arrows in R console</td>
<td>Tương tự</td>
<td>Chuyển đổi qua các lệnh đã chạy gần đây</td>
</tr>
<tr class="even">
<td>Shift + up/down arrows in script</td>
<td>Tương tự</td>
<td>Chọn nhiều dòng code</td>
</tr>
<tr class="odd">
<td>Ctrl + f</td>
<td>Cmd + f</td>
<td>Tìm và thay thế trong script hiện tại</td>
</tr>
<tr class="even">
<td>Ctrl + Shift + f</td>
<td>Cmd + Shift + f</td>
<td>Tìm trong các tệp (tìm/thay thế trên nhiều script)</td>
</tr>
<tr class="odd">
<td>Alt + l</td>
<td>Cmd + Option + l</td>
<td>Thu gọn code đã chọn</td>
</tr>
<tr class="even">
<td>Shift + Alt + l</td>
<td>Cmd + Shift + Option+l</td>
<td>Mở rộng code đã chọn</td>
</tr>
</tbody>
</table></div>
<p><span style="color: darkgreen;"><strong><em>MẸO:</em></strong> Sử dụng phím Tab của bạn khi nhập để sử dụng chức năng tự động hoàn thành của RStudio. Điều này có thể giúp ngăn ngừa các lỗi chính tả. Nhấn Tab trong khi nhập để hiện ra menu thả xuống gồm các hàm và đối tượng có thể có, dựa trên những gì bạn đã nhập.</span></p>
<!-- ======================================================= -->
</div>
</div>
<div id="functions" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Hàm<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h2>
<p>Các hàm là phần cốt lõi của việc sử dụng R. Hàm là cách bạn thực hiện các tác vụ và hoạt động. Nhiều hàm được cài đặt sẵn với R, nhiều hàm khác sẵn sàng để tải xuống trong các <em>packages</em> (giải thích trong phần <a href="basics.html#packages">packages</a>), và bạn thậm chí có thể viết các hàm tùy chỉnh của riêng mình!</p>
<p>Phần khái niệm cơ bản của hàm giải thích:</p>
<ul>
<li>Thế nào là một hàm và cách mà chúng hoạt động<br>
</li>
<li>Thế nào là <em>đối số</em> của hàm<br>
</li>
<li>Làm cách nào để nhận được sự trợ giúp khi tìm hiểu một hàm</li>
</ul>
<p><em>Lưu ý nhanh về cú pháp:</em> Trong cuốn sổ tay này, các hàm được viết dưới dạng code văn bản với dấu mở ngoặc đơn như sau: <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>. Như đã giải thích trong phần <a href="basics.html#packages">packages</a>, các hàm được tải xuống có sẵn trong các <em>packages</em>. Trong sổ tay này, tên các package được <strong>in đậm</strong>, ví dụ như <strong>dplyr</strong>. Đôi khi trong code ví dụ, bạn có thể thấy tên hàm được liên kết rõ ràng với tên package của chính hàm đó bằng hai dấu hai chấm (<code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code>) như thế này: <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code>. Mục đích của việc liên kết này sẽ được giải thích trong phần package.</p>
<!-- ======================================================= -->
<div id="các-hàm-cơ-bản" class="section level3 unnumbered">
<h3>Các hàm cơ bản<a class="anchor" aria-label="anchor" href="#c%C3%A1c-h%C3%A0m-c%C6%A1-b%E1%BA%A3n"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Một hàm giống như một cỗ máy nhận các dữ liệu đầu vào, thực hiện một số thao tác với dữ liệu đó và sản xuất kết quả đầu ra.</strong> Kết quả đầu ra như thế nào phụ thuộc vào hàm mà bạn sử dụng.</p>
<p><strong>Các hàm thường hoạt động dựa trên các đối tượng được đặt trong dấu ngoặc đơn của hàm</strong>. Ví dụ, hàm <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code> tính căn bậc hai của một số:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>Đối tượng được dùng cho một hàm cũng có thể là một cột trong tập dữ liệu (xem phần <a href="basics.html#objects">Đối tượng</a> để biết chi tiết về tất cả các loại đối tượng). Vì R có thể lưu trữ nhiều tập dữ liệu, bạn sẽ cần xác định cả tập dữ liệu và cột. Một cách để làm điều này là sử dụng ký hiệu <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> để liên kết tên của tập dữ liệu và tên của cột (<code>dataset$column</code>). Trong ví dụ dưới đây, hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> được áp dụng cho cột <code>age</code> trong tập dữ liệu <code>linelist</code>, và kết quả đầu ra là bản tóm tắt các giá trị số và giá trị missing của cột.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print summary statistics of column 'age' in the dataset 'linelist'</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    6.00   13.00   16.07   23.00   84.00      86</code></pre>
<p><span style="color: black;"><strong><em>LƯU Ý:</em></strong> Đằng sau một hàm là hệ thống code bổ sung phức tạp đã được gói gọn cho người dùng thành một lệnh đơn giản.</span></p>
<!-- ======================================================= -->
</div>
<div id="hàm-với-nhiều-đối-số" class="section level3 unnumbered">
<h3>Hàm với nhiều đối số<a class="anchor" aria-label="anchor" href="#h%C3%A0m-v%E1%BB%9Bi-nhi%E1%BB%81u-%C4%91%E1%BB%91i-s%E1%BB%91"><i class="fas fa-link"></i></a>
</h3>
<p>Các hàm thường yêu cầu một số dữ liệu đầu vào, được gọi là <strong><em>đối số</em></strong>, đặt trong dấu ngoặc đơn của hàm, thường được phân tách bằng dấu phẩy.</p>
<ul>
<li>Một vài đối số là bắt buộc để hàm hoạt động chính xác, những đối số khác là tùy chọn<br>
</li>
<li>Những đối số tùy chọn có thiết lập mặc định<br>
</li>
<li>Các đối số có thể nhận ký tự, số, logic (TRUE / FALSE) và các dữ liệu đầu vào khác</li>
</ul>
<p>Dưới đây là một hàm giả định thú vị, được gọi là <code>oven_bake()</code>, là ví dụ về một hàm điển hình. Hàm này nhận một đối tượng đầu vào (ví dụ: một tập dữ liệu, hoặc trong ví dụ này là “bột”) và thực hiện các hoạt động được xác định bởi các đối số bổ sung (<code>minutes =</code> and <code>temperature =</code>). Kết quả đầu ra có thể được in ra cửa sổ console hoặc được lưu dưới dạng một đối tượng bằng cách sử dụng toán tử gán <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>.</p>
<div class="inline-figure"><img src="images/Function_Bread_Example.png" width="75%" style="display: block; margin: auto;"></div>
<p><strong>Trong một ví dụ thực tế hơn</strong>, hàm <code>age_pyramid()</code> dưới đây tạo một biểu đồ tháp tuổi dựa trên nhóm tuổi đã xác định và cột phân tách nhị phân, ví dụ như <code>giới tính</code>. Hàm được cung cấp bởi ba đối số trong dấu ngoặc đơn và được phân tách nhau bằng dấu phẩy. Các giá trị được cung cấp cho các đối số thiết lập <code>linelist</code> là dataframe được sử dụng, <code>age_cat5</code> là cột để đếm và <code>giới tính</code> là cột nhị phân để sử dụng chia kim tự tháp theo màu.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create an age pyramid</span>
<span class="fu">age_pyramid</span><span class="op">(</span>data <span class="op">=</span> <span class="va">linelist</span>, age_group <span class="op">=</span> <span class="st">"age_cat5"</span>, split_by <span class="op">=</span> <span class="st">"gender"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="75%" height="75%"></div>
<p>Lệnh trên có thể được viết tương tự như bên dưới, theo cách dài hơn với một dòng mới cho mỗi đối số. Phong cách này có thể dễ đọc và dễ viết “bình luận” hơn với <code>#</code> để giải thích từng phần (bình luận mở rộng là một thực hành tốt!). Để chạy lệnh dài hơn này, bạn có thể bôi đen toàn bộ lệnh và nhấp vào “Run” hoặc chỉ cần đặt con trỏ vào dòng đầu tiên rồi nhấn đồng thời phím Ctrl và phím Enter.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create an age pyramid</span>
<span class="fu">age_pyramid</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">linelist</span>,        <span class="co"># use case linelist</span>
  age_group <span class="op">=</span> <span class="st">"age_cat5"</span>, <span class="co"># provide age group column</span>
  split_by <span class="op">=</span> <span class="st">"gender"</span>     <span class="co"># use gender column for two sides of pyramid</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="75%" height="75%"></div>
<p>Không cần xác định nửa đầu của phép gán đối số (ví dụ: <code>data =</code>) nếu các đối số được viết theo một thứ tự cụ thể (được chỉ định trong tài liệu của hàm). Đoạn code dưới đây tạo ra cùng một kim tự tháp như ở trên, bởi vì hàm kì vọng thứ tự đối số là: data frame, biến <code>age_group</code>, biến <code>split_by</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This command will produce the exact same graphic as above</span>
<span class="fu">age_pyramid</span><span class="op">(</span><span class="va">linelist</span>, <span class="st">"age_cat5"</span>, <span class="st">"gender"</span><span class="op">)</span></code></pre></div>
<p><strong>Một lệnh <code>age_pyramid()</code> phức tạp hơn có thể bao gồm các đối số <em>tùy chọn</em> để:</strong></p>
<ul>
<li>Hiển thị tỷ lệ thay vì số lượng (đặt <code>proportional = TRUE</code> khi giá trị mặc định là <code>FALSE</code>)<br>
</li>
<li>Chỉ định hai màu để sử dụng (<code>pal =</code> là viết tắt của “bảng màu” và được cung cấp với một vectơ gồm hai tên màu. Xem chương <a href="basics.html#objectstructure">đối tượng</a> để biết cách hàm <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> tạo ra một vectơ)</li>
</ul>
<p><span style="color: black;"><strong><em>LƯU Ý:</em></strong> Đối với các đối số mà bạn xác định với cả hai phần của đối số (ví dụ: <code>proportional = TRUE</code>), thứ tự của chúng trong tất cả các đối số không quan trọng.</span></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">age_pyramid</span><span class="op">(</span>
  <span class="va">linelist</span>,                    <span class="co"># use case linelist</span>
  <span class="st">"age_cat5"</span>,                  <span class="co"># age group column</span>
  <span class="st">"gender"</span>,                    <span class="co"># split by gender</span>
  proportional <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># percents instead of counts</span>
  pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"purple"</span><span class="op">)</span>  <span class="co"># colors</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="75%" height="75%"></div>
<!-- ======================================================= -->
</div>
<div id="viết-hàm" class="section level3 unnumbered">
<h3>Viết hàm<a class="anchor" aria-label="anchor" href="#vi%E1%BA%BFt-h%C3%A0m"><i class="fas fa-link"></i></a>
</h3>
<p>R là một ngôn ngữ được định hướng xung quanh hàm, vì thế bạn nên cảm thấy được trao quyền để tự viết các hàm của riêng mình. Việc tạo ra hàm mang đến một vài lợi thế:</p>
<ul>
<li>Tạo điều kiện thuận lợi cho lập trình mô-đun - tách code thành các phần độc lập và có thể quản lý<br>
</li>
<li>Thay thế việc copy-and-paste lặp đi lặp lại, điều mà có thể dễ xảy ra lỗi<br>
</li>
<li>Đặt tên dễ nhớ cho các đoạn code</li>
</ul>
<p>Cách viết một hàm được trình bày cụ thể trong chương <a href="writing-functions.html#writing-functions">Viết hàm</a>.</p>
<!-- A function is given a name and defined with the assignment operator `<-` to a special **base** R function called `function()`. Within the parentheses, the arguments that the function will accept are defined. This is followed by curly brackets `{ }`, within which the actual code of the function is written.     -->
<!-- The arguments should be provided in the syntax `argument = default`, separated by commas.   -->
<!-- Here is an example where we create a function `staff_calc()` to serve as a staffing calculator for COVID-19 case investigation and contact tracing calls.   -->
<!-- The arguments (inputs) and their default values will be:   -->
<!-- * `daily_cases = NULL` The number of new COVID-19 cases per day   -->
<!-- * `contacts_each = 5` The number contacts enumerated for each case   -->
<!-- * `time_case = 0.5`  Number of hours to complete a case investigaton by phone   -->
<!-- * `time_contact = 0.25`  Number of hours to complete a contact follow-up by phone   -->
<!-- * `time_day = 8` The number of hours one staff works per day   -->
<!-- Below, the function is created. The code ends with the special function `return()`, which is what the function produces.    -->
<!-- ```{r message=FALSE, warning=FALSE, out.width = "75%", out.height="75%"} -->
<!-- staff_calc <- function(daily_cases = NULL, contacts_each = 5, -->
<!--                        time_case = 0.5, time_contact = 0.25, time_day = 8){ -->
<!--   # Define total daily hours for calling cases -->
<!--   case_hours <- daily_cases * time_case  -->
<!--   # Define total daily hours for calling contacts -->
<!--   contact_hours <- daily_cases * contacts_each * time_contact -->
<!--   # Calculate number of staff required -->
<!--   staff_required <- (case_hours + contact_hours)/time_day -->
<!--   return(staff_required) -->
<!-- } -->
<!-- ``` -->
<!-- Once this code is run, the function will be defined and will appear in the R Environment. We can run the function. Below all the default values are used and the `daily_cases = ` is set to 150.   -->
<!-- There are many other nuances to understand when writing functions, as discussed in the page [Writing functions].   -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
<div id="packages" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Packages<a class="anchor" aria-label="anchor" href="#packages"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Packages chứa các hàm.</strong></p>
<p>Một package trong phần mềm R là một gói code và các tài liệu hướng dẫn có thể chia sẻ được chứa các hàm được định nghĩa trước. Cộng đồng người dùng phần mềm R luôn phát triển những package giúp giải quyết các vấn đề cụ thể, điều này có thể sẽ giúp bạn trong công việc của mình! Bạn sẽ có thể cần cài đặt và sử dụng hàng trăm package trong quá trình sử dụng phần mềm R.</p>
<p>Khi cài đặt, R đã có sẵn các package và hàm <strong>“cơ bản”</strong> giúp thực hiện các nhiệm vụ đơn giản. Nhưng nhiều người dùng R tạo ra các hàm chuyên biệt, được cộng đồng R kiểm chứng và bạn có thể tải xuống dưới dạng <strong>package</strong> để sử dụng theo cách của riêng mình. Trong sách này, tên package được viết <strong>in đậm</strong>. Một trong những khía cạnh thách thức hơn cả của R đó là thường có nhiều hàm hoặc package để lựa chọn nhằm hoàn thành một nhiệm vụ nhất định.</p>
<div id="cài-đặt-và-gọi" class="section level3 unnumbered">
<h3>Cài đặt và Gọi<a class="anchor" aria-label="anchor" href="#c%C3%A0i-%C4%91%E1%BA%B7t-v%C3%A0-g%E1%BB%8Di"><i class="fas fa-link"></i></a>
</h3>
<p><em>Các hàm</em> được chứa trong <strong>packages</strong> có thể được tải (“cài đặt”) về máy tính của bạn từ internet. Khi một package được tải xuống, package đó sẽ được lưu trữ trong “thư viện” của bạn. Sau đó, bạn có thể truy cập các hàm mà nó chứa trong phiên làm việc hiện tại trên R của bạn bằng cách “Gọi” package.</p>
<p><em>Hãy coi R là thư viện cá nhân của bạn</em>: Khi bạn tải xuống một package, thư viện của bạn nhận được một cuốn sách mới gồm các hàm, nhưng mỗi lần bạn muốn sử dụng một hàm trong cuốn sách đó, bạn phải mượn (“gọi”) cuốn sách đó từ thư viện của mình.</p>
<p>Tóm lại: để sử dụng các hàm có sẵn trong package R, phải thực hiện 2 bước:</p>
<ol style="list-style-type: decimal">
<li>Package phải được <strong>cài đặt</strong> (một lần), <em>và</em><br>
</li>
<li>Package phải được <strong>gọi</strong> (trong mỗi phiên làm việc của R)</li>
</ol>
<div id="thư-viện-của-bạn" class="section level4 unnumbered">
<h4>Thư viện của bạn<a class="anchor" aria-label="anchor" href="#th%C6%B0-vi%E1%BB%87n-c%E1%BB%A7a-b%E1%BA%A1n"><i class="fas fa-link"></i></a>
</h4>
<p>“Thư viện” của bạn thực ra là một thư mục trên máy tính của bạn, bao gồm các thư mục chứa các package đã được cài đặt. Hãy tìm nơi R được cài đặt trong máy tính của bạn và tìm kiếm một thư mục có tên “win-library”. Ví dụ: <code>R\win-library\4.0</code> (4.0 là phiên bản R - bạn sẽ có các thư viện khác nhau tùy theo phiên bản R mà bạn đã tải xuống).</p>
<p>Bạn có thể in ra đường dẫn tệp đến thư viện của mình bằng cách gõ lệnh <code><a href="https://rdrr.io/r/base/libPaths.html">.libPaths()</a></code> (dấu ngoặc bỏ trống). Điều này trở nên đặc biệt quan trọng nếu làm việc với <a href="network-drives.html#network-drives">R trên ổ cứng mạng</a>.</p>
</div>
<div id="cài-đặt-từ-cran" class="section level4 unnumbered">
<h4>Cài đặt từ CRAN<a class="anchor" aria-label="anchor" href="#c%C3%A0i-%C4%91%E1%BA%B7t-t%E1%BB%AB-cran"><i class="fas fa-link"></i></a>
</h4>
<p>Thông thường, người dùng R tải các package xuống từ CRAN. CRAN (Comprehensive R Archive Network - Mạng lưu trữ R toàn diện) là một kho công cộng trực tuyến gồm các package R đã được xuất bản bởi các thành viên cộng đồng R.</p>
<p>Bạn có cần lo lắng về vi-rút và bảo mật khi tải xuống một package từ CRAN? Đọc <a href="https://support.rstudio.com/hc/en-us/articles/360042593974-R-and-R-Package-Security">bài viết sau</a> để hiểm thêm về chủ đề này.</p>
</div>
<div id="làm-thế-nào-để-cài-đặt-và-gọi" class="section level4 unnumbered">
<h4>Làm thế nào để cài đặt và gọi<a class="anchor" aria-label="anchor" href="#l%C3%A0m-th%E1%BA%BF-n%C3%A0o-%C4%91%E1%BB%83-c%C3%A0i-%C4%91%E1%BA%B7t-v%C3%A0-g%E1%BB%8Di"><i class="fas fa-link"></i></a>
</h4>
<p>Trong sách này, chúng tôi khuyên bạn nên sử dụng package <strong>pacman</strong> (viết tắt của “package manager”). Nó cung cấp một hàm thuận tiện <code>p_load()</code> mà sẽ cài đặt một package nếu cần <em>và</em> gọi nó để sử dụng trong phiên làm việc hiện tại.</p>
<p>Cú pháp khá đơn giản. Chỉ cần liệt kê tên của các package trong dấu ngoặc đơn của hàm <code>p_load()</code> và phân tách chúng bằng dấu phẩy. Lệnh dưới đây sẽ cài đặt các package sau <strong>rio</strong>, <strong>tidyverse</strong>, và <strong>here</strong> nếu chúng chưa được cài đặt và sẽ gọi chúng ra để sử dụng. Điều này làm cho cách tiếp cận <code>p_load()</code> trở nên thuận tiện và ngắn gọn nếu chia sẻ scripts với người khác. Lưu ý rằng tên package có phân biệt chữ hoa chữ thường.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install (if necessary) and load packages for use</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">rio</span>, <span class="va">tidyverse</span>, <span class="va">here</span><span class="op">)</span></code></pre></div>
<p>Lưu ý rằng chúng ta đã sử dụng cú pháp <code><a href="https://rdrr.io/pkg/pacman/man/p_load.html">pacman::p_load()</a></code> để viết rõ ràng tên package (<strong>pacman</strong>) trước tên hàm (<code>p_load()</code>), được nối với nhau bằng hai dấu hai chấm <code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code>. Cú pháp này tiện dụng vì nó cũng gọi package <strong>pacman</strong> (giả sử package này đã được cài đặt).</p>
<p>Ngoài ra còn có các hàm <strong>base</strong> R thay thế mà bạn sẽ gặp thường xuyên. Hàm <strong>base</strong> R để cài đặt một package là <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>. Tên của package muốn cài đặt phải được đặt trong dấu ngoặc đơn bên trong <em>dấu ngoặc kép</em>. Nếu bạn muốn cài đặt nhiều package trong một lệnh, chúng phải được liệt kê trong một vectơ dạng ký tự <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>.</p>
<p>Lưu ý: lệnh này <em>cài đặt</em> một package, nhưng <em>không</em> gọi nó ra để sử dụng trong phiên làm việc hiện tại.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install a single package with base R</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span>

<span class="co"># install multiple packages with base R</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, <span class="st">"rio"</span>, <span class="st">"here"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Việc cài đặt cũng có thể được thực hiện bằng cách chọn và nhấp chuột vào cửa sổ RStudio “Package” và chọn “Install”, sau đó tìm kiếm tên package mong muốn cài đặt.</p>
<p>Hàm <strong>base</strong> R để <strong>gọi</strong> một package ra sử dụng (sau khi nó đã được cài đặt) là <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. Hàm này chỉ có thể gọi một package tại một thời điểm (cách khác của lệnh <code>p_load()</code>). Bạn có thể nhập tên package có hoặc không có dấu ngoặc kép.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load packages for use, with base R</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leeper/rio">rio</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></code></pre></div>
<p>Để kiểm tra xem một package đã được cài đặt và/hoặc đã được gọi hay chưa, bạn có thể xem Cửa số Package trong RStudio. Nếu package được cài đặt, nó sẽ hiển thị ở đó với số phiên bản. Nếu checkbox của nó được đánh dấu nghĩa là nó đã được gọi cho phiên làm việc hiện tại.</p>
<p><strong>Cài đặt từ Github</strong></p>
<p>Đôi khi, bạn cần cài đặt một package chưa có sẵn từ CRAN. Hoặc có lẽ package đã có sẵn trên CRAN nhưng bạn muốn <em>phiên bản mới hơn</em> với các tính năng mới chưa được cung cấp trong phiên bản cũ. Chúng thường được lưu trữ trên trang web <a href="https://github.com/">github.com</a> trong một “kho lưu trữ (repository)” code công khai và miễn phí. Đọc thêm về Github trong chương <a href="collaboration.html#collaboration">Version control với Git và Github</a>.</p>
<p>Để download packages R từ Github, bạn có thể dụng hàm <code>p_load_gh()</code> từ <strong>pacman</strong>, hàm này sẽ cài đặt package nếu cần và gọi nó để sử dụng cho phiên làm việc R hiện tại. Cách khác để cài đặt bao gồm sử dụng package <strong>remotes</strong> hoặc <strong>devtools</strong>. Đọc thêm về các hàm của <strong>pacman</strong> tại <a href="https://cran.r-project.org/web/packages/pacman/pacman.pdf">Tài liệu về package</a>.</p>
<p>Để cài đặt từ Github, bạn phải cung cấp thêm các thông tin sau:</p>
<ol style="list-style-type: decimal">
<li>Github ID của chủ sở hữu</li>
<li>Tên của repository chứa package<br>
</li>
<li><em>(Tùy chọn) Tên của “nhánh” (phiên bản phát triển cụ thể) mà bạn muốn tải xuống</em></li>
</ol>
<p>Trong các ví dụ dưới đây, từ đầu tiên trong dấu ngoặc kép là Github ID của chủ sở hữu kho lưu trữ, sau dấu gạch chéo là tên của kho lưu trữ (tên của package).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install/load the epicontacts package from its Github repository</span>
<span class="fu">p_load_gh</span><span class="op">(</span><span class="st">"reconhub/epicontacts"</span><span class="op">)</span></code></pre></div>
<p>Nếu bạn muốn cài đặt từ một “nhánh” (phiên bản) khác với nhánh chính, hãy thêm tên nhánh sau dấu “@”, được đặt phía sau tên kho lưu trữ.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install the "timeline" branch of the epicontacts package from Github</span>
<span class="fu">p_load_gh</span><span class="op">(</span><span class="st">"reconhub/epicontacts@timeline"</span><span class="op">)</span></code></pre></div>
<p>Nếu không có sự khác biệt giữa phiên bản Github và phiên bản trên máy tính của bạn, bạn không cần thực hiện thao tác này. Thay vào đó, bạn có thể “buộc” phải cài đặt lại bằng cách sử dụng <code>p_load_current_gh()</code> với đối số <code>update = TRUE</code>. Đọc thêm về <strong>pacman</strong> tại <a href="http://trinker.github.io/pacman/vignettes/Introduction_to_pacman.html">Minh họa trực tuyến</a></p>
<p><strong>Cài đặt từ ZIP hoặc TAR</strong></p>
<p>Bạn có thể cài đặt package từ một URL:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">packageurl</span> <span class="op">&lt;-</span> <span class="st">"https://cran.r-project.org/src/contrib/Archive/dsr/dsr_0.2.2.tar.gz"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">packageurl</span>, repos<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></code></pre></div>
<p>Hoặc, tải xuống máy tính của bạn dưới dạng tệp nén:</p>
<p>Cách 1: sử dụng lệnh <code>install_local()</code> từ package <strong>remotes</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_local.html">install_local</a></span><span class="op">(</span><span class="st">"~/Downloads/dplyr-master.zip"</span><span class="op">)</span></code></pre></div>
<p>Cách 2: sử dụng lệnh <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> của <strong>base</strong> R, cung cấp đường dẫn tệp đến tệp ZIP và thiết lập <code>type = "source</code> và <code>repos = NULL</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"~/Downloads/dplyr-master.zip"</span>, repos<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="cú-pháp-code" class="section level3 unnumbered">
<h3>Cú pháp code<a class="anchor" aria-label="anchor" href="#c%C3%BA-ph%C3%A1p-code"><i class="fas fa-link"></i></a>
</h3>
<p>Để tăng sự tường minh trong cuốn sách này, các hàm đôi khi sẽ được đặt sau tên package của chúng bằng cách sử dụng ký hiệu <code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code> theo cách sau: <code>package_name::function_name()</code></p>
<p>Khi một package được gọi cho một phiên làm việc, việc làm này là không cần thiết. Bạn chỉ cần sử dụng <code>function_name()</code>. Tuy nhiên, việc viết tên package sẽ hữu ích khi một tên hàm phổ biến và có thể tồn tại trong nhiều package (ví dụ: <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>). Việc viết tên package sẽ giúp gọi package trong trường hợp nó chưa được gọi ra.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This command uses the package "rio" and its function "import()" to import a dataset</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist.xlsx"</span>, which <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span></code></pre></div>
</div>
<div id="trợ-giúp-về-hàm" class="section level3 unnumbered">
<h3>Trợ giúp về hàm<a class="anchor" aria-label="anchor" href="#tr%E1%BB%A3-gi%C3%BAp-v%E1%BB%81-h%C3%A0m"><i class="fas fa-link"></i></a>
</h3>
<p>Để đọc thêm thông tin về một hàm, bạn có thể tìm kiếm hàm đó trong cửa sổ Help của RStudio nằm ở góc dưới bên phải. Hoặc bạn cũng có thể chạy một lệnh chẳng hạn như <code>?thefunctionname</code> (đặt tên của hàm sau dấu chấm hỏi) và trang Trợ giúp sẽ xuất hiện trong cửa sổ Help. Cuối cùng, hãy thử tìm kiếm trên internet.</p>
</div>
<div id="cập-nhật-packages" class="section level3 unnumbered">
<h3>Cập nhật packages<a class="anchor" aria-label="anchor" href="#c%E1%BA%ADp-nh%E1%BA%ADt-packages"><i class="fas fa-link"></i></a>
</h3>
<p>Bạn có thể cập nhật các packages bằng cách cài đặt lại chúng. Bạn cũng có thể bấm vào nút “Update” màu xanh lá cây trong cửa sổ packages của RStudio để xem packages nào có phiên bản mới để cài đặt. Lưu ý rằng code cũ của bạn có thể cần được cập nhật nếu có một bản sửa đổi lớn về cách hoạt động của một hàm!</p>
</div>
<div id="xóa-packages" class="section level3 unnumbered">
<h3>Xóa packages<a class="anchor" aria-label="anchor" href="#x%C3%B3a-packages"><i class="fas fa-link"></i></a>
</h3>
<p>Sử dụng <code>p_delete()</code> từ <strong>pacman</strong>, hoặc <code><a href="https://rdrr.io/r/utils/remove.packages.html">remove.packages()</a></code> từ <strong>base</strong> R. Ngoài ra, hãy tìm thư mục chứa thư viện của bạn và xóa thư mục theo cách thủ công.</p>
</div>
<div id="sự-phụ-thuộc" class="section level3 unnumbered">
<h3>Sự phụ thuộc<a class="anchor" aria-label="anchor" href="#s%E1%BB%B1-ph%E1%BB%A5-thu%E1%BB%99c"><i class="fas fa-link"></i></a>
</h3>
<p>Các packages thường phụ thuộc vào các packages khác để hoạt động. Chúng được gọi là sự phụ thuộc. Nếu một package không cài đặt được, thì package phụ thuộc vào nó có khả năng cũng không thể cài đặt được.</p>
<p>Xem sự phụ thuộc của một package với lệnh <code>p_depends()</code>, và xem package nào phụ thuộc vào nó với <code>p_depends_reverse()</code></p>
</div>
<div id="hàm-bị-che-giấu" class="section level3 unnumbered">
<h3>Hàm bị che giấu<a class="anchor" aria-label="anchor" href="#h%C3%A0m-b%E1%BB%8B-che-gi%E1%BA%A5u"><i class="fas fa-link"></i></a>
</h3>
<p>Không có gì lạ nếu hai hoặc nhiều packages chứa cùng một tên hàm. Ví dụ: packages <strong>dplyr</strong> có hàm <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>, nhưng package <strong>stats</strong> cũng vậy. Hàm <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> mặc định phụ thuộc vào thứ tự các package này được gọi lên trong phiên làm việc R - packages được gọi ra sau sẽ là mặc định cho hàm <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>.</p>
<p>Bạn có thể kiểm tra thứ tự của chúng trong cửa sổ Environment của R Studio - nhấp vào menu thả xuống “Global Environment” và xem thứ tự của các packages. Các hàm thuộc các packages <em>ở vị trí thấp hơn</em> trong danh sách thả xuống đó sẽ che giấu các hàm cùng tên trong các packages xuất hiện ở vị trí bên trên trong danh sách thả xuống. Khi bạn vừa gọi một package, R sẽ cảnh báo bạn trong bảng điều khiển nếu xảy ra hiện tượng này, nhưng điều này rất hay bị bỏ quên.</p>
<div class="inline-figure"><img src="images/masking_functions.png" width="50%" style="display: block; margin: auto;"></div>
<p>Dưới đây là những cách bạn có thể sửa lỗi hàm bị che giấu:</p>
<ol style="list-style-type: decimal">
<li>Ghi rõ tên package trong lệnh. Ví dụ, sử dụng <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code><br>
</li>
<li>Sắp xếp lại thứ tự mà các package được tải (ví dụ trong <code>p_load()</code>), và <strong>bắt đầu một phiên làm việc R mới</strong>
</li>
</ol>
</div>
<div id="gỡ-package" class="section level3 unnumbered">
<h3>Gỡ package<a class="anchor" aria-label="anchor" href="#g%E1%BB%A1-package"><i class="fas fa-link"></i></a>
</h3>
<p>Để gỡ (detach) một package, hãy sử dụng lệnh dưới đây, với tên package chính xác và chỉ có một dấu hai chấm. Lưu ý rằng điều này có thể không giải quyết được việc hàm bị che giấu.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/detach.html">detach</a></span><span class="op">(</span><span class="va">package</span><span class="op">:</span><span class="va">PACKAGE_NAME_HERE</span>, unload<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="cài-đặt-phiên-bản-cũ-hơn" class="section level3 unnumbered">
<h3>Cài đặt phiên bản cũ hơn<a class="anchor" aria-label="anchor" href="#c%C3%A0i-%C4%91%E1%BA%B7t-phi%C3%AAn-b%E1%BA%A3n-c%C5%A9-h%C6%A1n"><i class="fas fa-link"></i></a>
</h3>
<p>Xem <a href="https://support.rstudio.com/hc/en-us/articles/219949047-Installing-older-versions-of-packages">hướng dẫn</a> này để cài đặt phiên bản cũ hơn của một package cụ thể.</p>
</div>
<div id="packages-đề-xuất" class="section level3 unnumbered">
<h3>Packages đề xuất<a class="anchor" aria-label="anchor" href="#packages-%C4%91%E1%BB%81-xu%E1%BA%A5t"><i class="fas fa-link"></i></a>
</h3>
<p>Xem chương <a href="packages-suggested.html#packages-suggested">Package đề xuất</a> để biết danh sách các packages thường được sử dụng trong dịch tễ học.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="scripts" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Scripts<a class="anchor" aria-label="anchor" href="#scripts"><i class="fas fa-link"></i></a>
</h2>
<p>Scripts là một phần cơ bản của lập trình. Chúng là các tài liệu chứa các câu lệnh của bạn (ví dụ: các hàm để tạo và chỉnh sửa bộ số liệu, các hàm để in các biểu đồ trực quan hóa số liệu, v.v.). Bạn có thể lưu một scripts và chạy lại sau này. Có nhiều lợi ích để lưu trữ và chạy các lệnh của bạn từ một scripts (so với nhập “từng lệnh” vào R console):</p>
<ul>
<li>Tiện dụng - bạn có thể chia sẻ công việc của mình với người khác bằng cách gửi cho họ các tập lệnh của bạn<br>
</li>
<li>Khả năng tái lập - để bạn và những người khác biết chính xác những gì bạn đã làm<br>
</li>
<li>Kiểm soát phiên bản - để bạn có thể theo dõi các thay đổi do chính bạn hoặc đồng nghiệp thực hiện<br>
</li>
<li>Dễ dàng nhận xét/chú thích - để giải thích cho đồng nghiệp của bạn những gì bạn đã làm</li>
</ul>
<div id="bình-luận" class="section level3 unnumbered">
<h3>Bình luận<a class="anchor" aria-label="anchor" href="#b%C3%ACnh-lu%E1%BA%ADn"><i class="fas fa-link"></i></a>
</h3>
<p>Khi viết script, bạn có thể thêm các chú thích (“bình luận”) xung quanh code R của bạn. Bình luận là cần thiết để giải thích cho chính bạn và những người đọc khác hiểu những gì bạn đang làm. Bạn có thể thêm bình luận bằng cách nhập dấu thăng (#) và viết bình luận của bạn sau đó. Nội dung bình luận sẽ xuất hiện với màu khác với code R.</p>
<p>Bất kỳ code nào được viết sau dấu # sẽ không được chạy. Do đó, đặt dấu # trước dòng code cũng là một cách hữu ích để tạm thời vô hiệu hóa một dòng code (“comment out”) nếu bạn không muốn xóa nó). Bạn có thể comment out/in nhiều dòng cùng một lúc bằng cách bôi đen chúng và nhấn Ctrl + Shift + c (Cmd + Shift + c trong Mac).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A comment can be on a line by itself</span>
<span class="co"># import data</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># a comment can also come after code</span>
<span class="co"># filter(age &gt; 50)                          # It can also be used to deactivate / remove a line of code</span>
  <span class="fu">count</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<ul>
<li>Bình luận <em>những gì</em> bạn đang làm <em>và <strong>tại sao</strong> bạn làm như vậy</em>.<br>
</li>
<li>Chia code của bạn thành các phần hợp lý<br>
</li>
<li>Kèm theo code của bạn với mô tả từng bước về những gì đang được thực hiện (ví dụ: các bước được đánh số)</li>
</ul>
</div>
<div id="phong-cách-viết-code-1" class="section level3 unnumbered">
<h3>Phong cách viết code<a class="anchor" aria-label="anchor" href="#phong-c%C3%A1ch-vi%E1%BA%BFt-code-1"><i class="fas fa-link"></i></a>
</h3>
<p>Phong cách viết code của bạn rất quan trọng - đặc biệt là khi làm việc theo nhóm. Chúng tôi khuyên bạn nên tuân theo <a href="https://style.tidyverse.org/">hướng dẫn</a> phong cách viết code <strong>tidyverse</strong> . Bên cạnh đó còn có các packages khác như <strong>styler</strong> và <strong>lintr</strong> để giúp bạn tuân theo phong cách này.</p>
<p>Một vài điểm rất cơ bản để làm cho code của bạn dễ dàng đọc được đối với người khác:<br>
* Khi đặt tên cho các đối tượng, chỉ sử dụng các chữ cái viết thường, số và dấu gạch dưới <code>_</code>, ví dụ: <code>my_data</code><br>
* Thường xuyên sử dụng dấu cách, bao gồm cả xung quanh các toán tử, ví dụ: <code>n = 1</code> và <code>age_new &lt;- age_old + 3</code></p>
</div>
<div id="ví-dụ-về-script" class="section level3 unnumbered">
<h3>Ví dụ về Script<a class="anchor" aria-label="anchor" href="#v%C3%AD-d%E1%BB%A5-v%E1%BB%81-script"><i class="fas fa-link"></i></a>
</h3>
<p>Dưới đây là một ví dụ về một đoạn ngắn R script. Hãy nhớ rằng, bạn càng giải thích ngắn gọn lệnh code của mình trong phần bình luận, thì đồng nghiệp của bạn sẽ càng thích bạn!</p>
<div class="inline-figure"><img src="images/example_script.png" width="100%" style="display: block; margin: auto;"></div>
<!-- ======================================================= -->
</div>
<div id="r-markdown" class="section level3 unnumbered">
<h3>R markdown<a class="anchor" aria-label="anchor" href="#r-markdown"><i class="fas fa-link"></i></a>
</h3>
<p>R markdown là một dạng của R script và có khả năng <em>xuất</em> thành các tệp đầu ra (PDF, Word, HTML, Powerpoint, v.v.). Đây là những công cụ vô cùng hữu ích và linh hoạt thường được sử dụng để tạo các báo cáo tự động. Ngay cả trang web và cuốn sách này cũng được viết bằng R markdown!</p>
<p>Bạn cần biết rằng những người mới bắt đầu dùng R cũng có thể sử dụng R Markdown - do đó đừng sợ! Để tìm hiểu thêm, hãy xem chương <a href="rmarkdown.html#rmarkdown">Báo cáo với R Markdown</a> trong cuốn sách này.</p>
<!-- ======================================================= -->
</div>
<div id="r-notebooks" class="section level3 unnumbered">
<h3>R notebooks<a class="anchor" aria-label="anchor" href="#r-notebooks"><i class="fas fa-link"></i></a>
</h3>
<p>Không có sự khác biệt trong cách viết giữa R markdown và R notebook. Tuy nhiên, việc thực thi của hai loại file này hơi khác nhau một chút. Xem trang <a href="http://uc-r.github.io/r_notebook">Web</a> này để biết thêm chi tiết.</p>
<!-- ======================================================= -->
</div>
<div id="shiny" class="section level3 unnumbered">
<h3>Shiny<a class="anchor" aria-label="anchor" href="#shiny"><i class="fas fa-link"></i></a>
</h3>
<p>Shiny apps/websites được chứa trong một script có tên <code>app.R</code>. Tệp này có ba thành phần:</p>
<ol style="list-style-type: decimal">
<li>Giao diện người dùng (ui)<br>
</li>
<li>Một hàm máy chú<br>
</li>
<li>Một lệng gọi hàm <code>shinyApp</code>
</li>
</ol>
<p>Xem thêm trong cuốn sách này tại chương <a href="shiny-basics.html#shiny-basics">Dashboards với Shiny</a>, hoặc hướng dẫn trực tuyến này: <a href="https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/">Shiny tutorial</a></p>
<p><em>Trước đây, tệp bên trên được chia thành 2 tệp con (<code>ui.R</code> và <code>server.R</code>)</em></p>
</div>
<div id="thu-gọn-code" class="section level3 unnumbered">
<h3>Thu gọn Code<a class="anchor" aria-label="anchor" href="#thu-g%E1%BB%8Dn-code"><i class="fas fa-link"></i></a>
</h3>
<p>Bạn có thể thu gọn các đoạn code để làm cho script của bạn dễ đọc hơn.</p>
<p>Để làm điều này, hãy tạo tiêu đề văn bản bằng dấu thăng #, viết tiêu đề của bạn và thêm vào phía sau nó ít nhất hoặc là 4 dấu gạch ngang (-), dấu thăng (#) hoặc dấu bằng (=). Ngay sau đó, một mũi tên nhỏ sẽ xuất bên cạnh ở bên phải số thự tự của dòng lệnh. Bạn có thể nhấp vào mũi tên này và phần code bên dưới sẽ được thu gọn cho đến trước tiêu đề tiếp theo và một mũi tên hai chiều xuất hiện ở đây.</p>
<p>Để mở rộng lại đoạn code đã thu gọn, hãy nhấp lại vào mũi tên hoặc biểu tượng mũi tên hai chiều. Ngoài ra còn có thể sử dụng thêm các phím tắt như đã được giải thích trong <a href="basics.html#rstudio">mục RStudio</a> của chương này.</p>
<p>Bằng cách tạo tiêu đề bằng #, bạn cũng sẽ kích hoạt Mục lục ở cuối tập lệnh của mình (xem bên dưới) mà bạn có thể sử dụng để điều hướng tập lệnh của mình. Bạn có thể tạo tiêu đề phụ bằng cách thêm các ký hiệu #, ví dụ: # # cho tiêu đề chính, ## fcho tiêu đề thứ hai, và ### cho tiêu đề thứ ba.</p>
<p>Dưới đây là hai phiên bản của một ví dụ cho script. Ở bên trái là bản gốc với các tiêu đề được chú thích. Ở bên phải, bốn dấu gạch ngang đã được viết sau mỗi tiêu đề, làm cho chúng có thể thu gọn được. Hai trong số chúng đã được thu gọn và bạn có thể thấy Mục lục ở dưới cùng hiện hiển thị từng phần.</p>
<p><img src="images/code_folding1.png" width="50%"><img src="images/code_folding2.png" width="50%"></p>
<p>Các phần code khác mặc định đủ điều kiện để thu gọn bao gồm các phần “nằm giữa” hai dấu ngoặc nhọn <code>{ }</code>, chẳng hạn như định nghĩa hàm hoặc các khối điều kiện (câu lệnh if else). Bạn có thể đọc thêm về cách thu gọn code tại <a href="https://support.rstudio.com/hc/en-us/articles/200484568-Code-Folding-and-Sections">trang của Rstudio</a>.</p>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
<div id="thư-mục-làm-việc" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> Thư mục làm việc<a class="anchor" aria-label="anchor" href="#th%C6%B0-m%E1%BB%A5c-l%C3%A0m-vi%E1%BB%87c"><i class="fas fa-link"></i></a>
</h2>
<p>Thư mục làm việc là vị trí thư mục gốc được R sử dụng cho công việc của bạn - nơi R tìm kiếm và lưu các tệp theo mặc định. Mặc định là, R sẽ lưu các tệp mới và xuất tệp vào vị trí này, đồng thời sẽ tìm kiếm các tệp để nhập dữ liệu (ví dụ: bộ dữ liệu) tại đây.</p>
<p>Thư mục làm việc xuất hiện bằng dòng chữ màu xám ở phía trên cửa sổ Rstudio Console. Bạn cũng có thể in thư mục làm việc hiện tại bằng cách chạy lệnh <code><a href="https://rdrr.io/r/base/getwd.html">getwd()</a></code> (để trống dấu ngoặc đơn).</p>
<div class="inline-figure"><img src="images/working_directory_1.png" width="100%" style="display: block; margin: auto;"></div>
<div id="gợi-ý-cách-tiếp-cận" class="section level3 unnumbered">
<h3>Gợi ý cách tiếp cận<a class="anchor" aria-label="anchor" href="#g%E1%BB%A3i-%C3%BD-c%C3%A1ch-ti%E1%BA%BFp-c%E1%BA%ADn"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Xem thêm tại chương <a href="r-projects.html#r-projects">Dự án R</a> để biết chi tiết về gợi ý các cách tiếp cận của chúng tôi trong việc quản lý thư mục làm việc của bạn.</strong><br>
Một cách phổ biến, hiệu quả và không gặp sự cố khi quản lý thư mục làm việc và đường dẫn tệp là kết hợp 3 yếu tố này trong một quy trình làm việc với [Dự án R][R projects] có định hướng :</p>
<ol style="list-style-type: decimal">
<li>Một dự án R để lưu trữ tất cả tệp của bạn (xem tại chương <a href="r-projects.html#r-projects">Dự án R</a>)<br>
</li>
<li>Package <strong>here</strong> để định vị tệp (xem tại [Import and export])<br>
</li>
<li>The <strong>rio</strong> package to import/export files (see page on <a href="importing.html#importing">Nhập xuất dữ liệu</a>)</li>
</ol>
<!-- ======================================================= -->
</div>
<div id="thiết-lập-bằng-lệnh" class="section level3 unnumbered">
<h3>Thiết lập bằng lệnh<a class="anchor" aria-label="anchor" href="#thi%E1%BA%BFt-l%E1%BA%ADp-b%E1%BA%B1ng-l%E1%BB%87nh"><i class="fas fa-link"></i></a>
</h3>
<p>Cho tới gần đây, nhiều người học R đã được dạy để bắt đầu script của họ bằng lệnh <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code>. Hãy thay đổi thói quen đó bằng cách sử dụng [Dự án R][R projects] và đọc thêm tài liệu sau để hiểu <a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/">lý do không nên sử dụng <code>setwd()</code></a>. Một cách ngắn gọn là, công việc của bạn chỉ thực hiện được trên máy tính của bạn, các đường dẫn tệp được sử dụng để nhập và xuất tệp trở nên “dễ lỗi” và điều này cản trở nghiêm trọng đến việc cộng tác và sử dụng code của bạn trên bất kỳ máy tính nào khác. Bạn có những lựa chọn khác dễ dàng hơn!</p>
<p>Như đã nói ở trên, mặc dù chúng tôi không khuyến nghị phương pháp này trong hầu hết các trường hợp, bạn vẫn có thể sử dụng lệnh <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> với đường dẫn tệp thư mục mong muốn trong dấu ngoặc kép, ví dụ:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"C:/Documents/R Files/My analysis"</span><span class="op">)</span></code></pre></div>
<p><span style="color: red;"><strong><em>NGUY HIỂM:</em></strong> thiết lập một thư mục làm việc với <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> <em>có thể</em> dẫn đến “lỗi” nếu đường dẫn tệp dành riêng cho một máy tính. Thay vào đó, hãy sử dụng đường dẫn tệp liên quan đến thư mục gốc Dự án R (với package <strong>here</strong>).</span></p>
<!-- ======================================================= -->
</div>
<div id="thiết-lập-thủ-công" class="section level3 unnumbered">
<h3>Thiết lập thủ công<a class="anchor" aria-label="anchor" href="#thi%E1%BA%BFt-l%E1%BA%ADp-th%E1%BB%A7-c%C3%B4ng"><i class="fas fa-link"></i></a>
</h3>
<p>Để thiết lập thư mục làm việc một cách thủ công (trỏ và nhấp tương đương với <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code>), hãy chọn mục Session trên thanh công cụ và chọn “Set Working Directory”, sau đó chọn “Choose Directory”. Chú ý: nếu sử dụng phương pháp này, bạn sẽ phải thực hiện việc này theo cách thủ công mỗi khi mở RStudio.</p>
<!-- ======================================================= -->
</div>
<div id="thiết-lập-bên-trong-một-dự-án-r" class="section level3 unnumbered">
<h3>Thiết lập bên trong một dự án R<a class="anchor" aria-label="anchor" href="#thi%E1%BA%BFt-l%E1%BA%ADp-b%C3%AAn-trong-m%E1%BB%99t-d%E1%BB%B1-%C3%A1n-r"><i class="fas fa-link"></i></a>
</h3>
<p>Nếu bạn đang mở một dự án R, thư mục làm việc sẽ mặc định là thư mục gốc của dự án R có chứa tệp “.rproj”. Điều này sẽ áp dụng nếu bạn mở RStudio bằng cách nhấp vào mở R Project (tệp có phần mở rộng “.rproj”).</p>
<!-- ======================================================= -->
</div>
<div id="thư-mục-làm-việc-với-r-markdown" class="section level3 unnumbered">
<h3>Thư mục làm việc với R markdown<a class="anchor" aria-label="anchor" href="#th%C6%B0-m%E1%BB%A5c-l%C3%A0m-vi%E1%BB%87c-v%E1%BB%9Bi-r-markdown"><i class="fas fa-link"></i></a>
</h3>
<p>Trong script ở R markdown, thư mục làm việc mặc định là thư mục chứa tệp R markdown (<code>.Rmd</code>). Nếu sử dụng dự án R và package <strong>here</strong>, điều này sẽ không được áp dụng. Để biết thư mục làm việc là gì, sử dụng lệnh <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> như đã được giải thích tại chương <a href="r-projects.html#r-projects">Dự án R</a>.</p>
<p>Nếu bạn muốn thay đổi thư mục làm việc của một tệp độc lập ở R markdown (không phải ở dự án R), nếu bạn sử dụng <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> điều này sẽ chỉ áp dụng chỉ cho đoạn code đó. Để thực hiện thay đổi cho tất cả các đoạn code trong R markdown, hãy điều chỉnh ở bước thiết lập để thêm tham số <code>root.dir =</code>, như bên dưới:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>root.dir <span class="op">=</span> <span class="st">'desired/directorypath'</span><span class="op">)</span></code></pre></div>
<p>Cách này dễ hơn nhiều so với chỉ sử dụng R markdown bên trong một dự án R và sử dụng package <strong>here</strong>.</p>
<!-- ======================================================= -->
</div>
<div id="cung-cấp-đường-dẫn-tệp" class="section level3 unnumbered">
<h3>Cung cấp đường dẫn tệp<a class="anchor" aria-label="anchor" href="#cung-c%E1%BA%A5p-%C4%91%C6%B0%E1%BB%9Dng-d%E1%BA%ABn-t%E1%BB%87p"><i class="fas fa-link"></i></a>
</h3>
<p>Có lẽ điều khiến những người mới bắt đầu với R cảm thấy nản nhất (ít nhất là với người dùng máy tính Windows) đó là gõ đường dẫn tệp để nhập xuất dữ liệu. Chúng tôi có giải thích cặn kẽ về cách tạo đường dẫn tệp đầu vào tốt nhất trong chương <a href="importing.html#importing">Nhập xuất dữ liệu</a>, nhưng dưới đây là một số điểm chính:</p>
<p><strong>Đường dẫn tệp bị lỗi</strong></p>
<p>Dưới đây là ví dụ về đường dẫn tệp “tuyệt đối” hoặc “địa chỉ đầy đủ”. Chúng có thể bị lỗi nếu được sử dụng bởi một máy tính khác. Một ngoại lệ là nếu bạn đang sử dụng ổ đĩa chia sẻ/mạng.</p>
<pre><code>C:/Users/Name/Document/Analytic Software/R/Projects/Analysis2019/data/March2019.csv  </code></pre>
<p><strong>Đường dẫn với dấu gạch chéo</strong></p>
<p><em>Nếu nhập đường dẫn tệp, hãy lưu ý hướng của các dấu gạch chéo.</em> Sử dụng dấu <em>gạch chéo xuôi</em> (<code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code>) để tách các thành phần (“data/provincial.csv”). Đối với người dùng Windows, cách mặc định mà đường dẫn tệp được hiển thị là dấu <em>gạch chéo ngược</em> (\) - vì vậy bạn sẽ cần phải thay đổi hướng của mỗi dấu gạch chéo. Nếu bạn sử dụng package <strong>here</strong> được miêu tả ở <a href="r-projects.html#r-projects">Dự án R</a> thì dấu gạch chéo không còn là vấn đề với bạn nữa.</p>
<p><strong>Đường dẫn tệp tương đối</strong></p>
<p>Nói chung, chúng tôi khuyên bạn nên cung cấp các đường dẫn tệp theo cách “tương đối” - nghĩa là, đường dẫn <em>liên quan đến</em> thư mục gốc Dự án R của bạn. Bạn có thể thực hiện việc này bằng cách sử dụng package <strong>here</strong> như được giải thích trong chương <a href="r-projects.html#r-projects">Dự án R</a>. Một đường dẫn tệp tương đối sẽ trông như thế này:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Import csv linelist from the data/linelist/clean/ sub-folders of an R project</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"linelists"</span>, <span class="st">"marin_country.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Ngay cả khi sử dụng đường dẫn tệp tương đối trong dự án R, bạn vẫn có thể sử dụng đường dẫn tuyệt đối để nhập/xuất dữ liệu ở bên ngoài dự án R của bạn.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="objects" class="section level2" number="3.10">
<h2>
<span class="header-section-number">3.10</span> Đối tượng<a class="anchor" aria-label="anchor" href="#objects"><i class="fas fa-link"></i></a>
</h2>
<p>Mọi thứ trong R đều là một đối tượng, và R là một ngôn ngữ “lập trình hướng đối tượng”. Các phần dưới đây sẽ giải thích:</p>
<ul>
<li>Cách tạo ra các đối tượng (<code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>)</li>
<li>Các loại đối tượng (ví dụ: data frames, vectors..)<br>
</li>
<li>Cách truy cập các tập con của đối tượng (ví dụ: các biến số trong một bộ dữ liệu)<br>
</li>
<li>Các loại đối tượng (ví dụ: numeric, logical, integer, double, character, factor)</li>
</ul>
<!-- ======================================================= --><div id="mọi-thứ-đều-là-một-đối-tượng" class="section level3 unnumbered">
<h3>Mọi thứ đều là một đối tượng<a class="anchor" aria-label="anchor" href="#m%E1%BB%8Di-th%E1%BB%A9-%C4%91%E1%BB%81u-l%C3%A0-m%E1%BB%99t-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng"><i class="fas fa-link"></i></a>
</h3>
<p><em>Phần này được dựa theo sách <a href="https://r4epis.netlify.app/training/r_basics/objects/">R4Epis project</a>.</em><br>
Mọi thứ bạn lưu trữ trong R - bao gồm bộ dữ liệu, biến số, danh sách tên làng, tổng số dân, thậm chí cả kết quả đầu ra như biểu đồ - đều là <strong>các đối tượng</strong>, được <strong>gán tên</strong> và <strong>có thể được tham chiếu</strong> trong các lệnh sau đó.</p>
<p>Một đối tượng tồn tại khi bạn đã gán giá trị cho nó (xem phần gán bên dưới). Khi nó được gán một giá trị, đối tượng sẽ xuất hiện trong cửa sổ Environment (xem cửa sổ phía trên bên phải của RStudio). Sau đó, nó có thể được sử dụng, thao tác, thay đổi và định nghĩa lại.</p>
<!-- ======================================================= -->
</div>
<div id="định-nghĩa-một-đối-tượng--" class="section level3 unnumbered">
<h3>Định nghĩa một đối tượng (<code>&lt;-</code>)<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%8Bnh-ngh%C4%A9a-m%E1%BB%99t-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng--"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Tạo ra một đối tượng <em>bằng cách gán cho chúng một giá trị</em> bằng toán tử &lt;-.</strong><br>
Bạn có thể nghĩ về toán tử gán <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code> tương đương với từ “được định nghĩa là”. Các lệnh gán thường tuân theo một trật tự quy định:</p>
<p><strong>tên đối tượng</strong> &lt;- <strong>giá trị của đối tượng</strong> (hoặc quy trình / tính toán tạo ra giá trị)</p>
<p>Ví dụ: bạn muốn ghi nhận một báo cáo tuần dịch tễ học hiện tại dưới dạng một đối tượng để tham chiếu tới code của bạn sau này. Trong ví dụ này, đối tượng <code>current_week</code> được tạo khi nó được gán giá trị <code>"2018-W10"</code> (dấu ngoặc kép sẽ quy định đây là giá trị dạng chữ). Đối tượng <code>current_week</code> sẽ xuất hiện trong cửa sổ RStudio Environment (phía trên bên phải) và có thể được tham chiếu tới các lệnh sau này.</p>
<p>Xem các lệnh R và kết quả của chúng như dưới đây.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">current_week</span> <span class="op">&lt;-</span> <span class="st">"2018-W10"</span>   <span class="co"># this command creates the object current_week by assigning it a value</span>
<span class="va">current_week</span>                 <span class="co"># this command prints the current value of current_week object in the console</span></code></pre></div>
<pre><code>## [1] "2018-W10"</code></pre>
<p><span style="color: black;"><strong><em>CHÚ Ý:</em></strong> Lưu ý rằng số <code>[1]</code> trong kết quả ở R console đơn giản là chỉ ra rằng bạn đang xem mục đầu tiên của đầu ra</span></p>
<p><span style="color: orange;"><strong><em>THẬN TRỌNG:</em></strong> <strong>Giá trị của một đối tượng có thể bị ghi đè</strong> bất kỳ lúc nào bằng cách chạy lệnh gán để định nghĩa lại giá trị của nó. Do đó, <strong>thứ tự của các lệnh được chạy rất quan trọng</strong>.</span></p>
<p>Lệnh sau sẽ định nghĩa lại giá trị của đối tượng <code>current_week</code>:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">current_week</span> <span class="op">&lt;-</span> <span class="st">"2018-W51"</span>   <span class="co"># assigns a NEW value to the object current_week</span>
<span class="va">current_week</span>                 <span class="co"># prints the current value of current_week in the console</span></code></pre></div>
<pre><code>## [1] "2018-W51"</code></pre>
<p><strong>Dấu bằng <code><a href="https://rdrr.io/r/base/assignOps.html">=</a></code></strong></p>
<p>Bạn cũng sẽ thấy các dấu bằng trong R code:</p>
<ul>
<li>Hai dấu bằng <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code> giữa hai đối tượng hoặc giá trị dùng để đặt một <em>câu hỏi</em> logic: “cái này có bằng cái kia không?”.<br>
</li>
<li>Bạn cũng sẽ thấy các dấu bằng trong các hàm được sử dụng để xác định giá trị của các đối số của hàm (đọc thêm ở các phần bên dưới), ví dụ: <code><a href="https://rdrr.io/r/base/Extremes.html">max(age, na.rm = TRUE)</a></code>.<br>
</li>
<li>Bạn <em>có thể</em> sử dụng một dấu bằng <code><a href="https://rdrr.io/r/base/assignOps.html">=</a></code> thay cho dấu <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code> để tạo và định nghĩa các đối tượng, nhưng điều này không được khuyến khích. Bạn có thể đọc về lý do tại sao điều này không được khuyến khích ở <a href="https://renkun.me/2014/01/28/difference-between-assignment-operators-in-r/">đây</a>.</li>
</ul>
<p><strong>Bộ dữ liệu</strong></p>
<p>Bộ dữ liệu (datasets) cũng là một đối tượng (thường là một “dataframes”) và phải được gán tên khi chúng được nhập. Trong đoạn mã dưới đây, đối tượng <code>linelist</code> được tạo và gán giá trị từ tệp CSV, tệp này được nhập bằng package <strong>rio</strong> và hàm <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> của package này.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># linelist is created and assigned the value of the imported CSV file</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"my_linelist.csv"</span><span class="op">)</span></code></pre></div>
<p>Bạn có thể đọc thêm về nhập và xuất dữ liệu trong chương <a href="importing.html#importing">Nhập xuất dữ liệu</a>.</p>
<p><span style="color: orange;"><strong><em>THẬN TRỌNG:</em></strong> Lưu ý nhanh về cách đặt tên đối tượng:</span></p>
<ul>
<li>Tên đối tượng không được chứa dấu cách, nhưng bạn nên sử dụng dấu gạch dưới (_) hoặc dấu chấm (.) thay vì dấu cách.<br>
</li>
<li>Tên đối tượng phân biệt chữ hoa và chữ thường (nghĩa là Dataset_A khác với dataset_A).</li>
<li>Tên đối tượng phải bắt đầu bằng chữ cái (không được bắt đầu bằng số như 1, 2 hoặc 3).</li>
</ul>
<p><strong>Kết quả đầu ra</strong></p>
<p>Các kết quả đầu ra như bảng và biểu đồ cung cấp một ví dụ về cách các kết quả đầu ra có thể được lưu dưới dạng đối tượng hoặc chỉ được in ra mà không cần lưu. Ví dụ, một bảng chéo giữa giới tính và biến kết cục được tạo ra bởi hàm <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> trong <strong>base</strong> R, có thể được in trực tiếp vào R console (<em>mà không</em> cần lưu).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># printed to R console only</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">gender</span>, <span class="va">linelist</span><span class="op">$</span><span class="va">outcome</span><span class="op">)</span></code></pre></div>
<pre><code>##    
##     Death Recover
##   f  1227     953
##   m  1228     950</code></pre>
<p>Nhưng bảng này cũng có thể được lưu dưới dạng một đối tượng được đặt tên. Sau đó, bạn có thể in nó ra.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save</span>
<span class="va">gen_out_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">gender</span>, <span class="va">linelist</span><span class="op">$</span><span class="va">outcome</span><span class="op">)</span>

<span class="co"># print</span>
<span class="va">gen_out_table</span></code></pre></div>
<pre><code>##    
##     Death Recover
##   f  1227     953
##   m  1228     950</code></pre>
<p><strong>Cột</strong></p>
<p>Các cột trong tập dữ liệu cũng là các đối tượng và có thể được định nghĩa, ghi đè và tạo như được mô tả bên dưới trong phần Cột.</p>
<p>Bạn có thể sử dụng toán tử gán từ <strong>base</strong> R để tạo một cột mới. Dưới đây, cột mới <code>bmi</code> (Body Mass Index) được tạo, và giá trị mới ứng với mỗi hàng là kết quả của một phép toán trên giá trị của các hàng trong cột <code>wt_kg</code> và cột <code>ht_cm</code>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create new "bmi" column using base R syntax</span>
<span class="va">linelist</span><span class="op">$</span><span class="va">bmi</span> <span class="op">&lt;-</span> <span class="va">linelist</span><span class="op">$</span><span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></code></pre></div>
<p>Tuy nhiên, trong cuốn sách này, chúng tôi tập trung vào một cách tiếp cận khác để định nghĩa cột, sử dụng hàm <code>mutate()</code> trong package <strong>dplyr</strong> và <em>piping</em> với toán tử pipe (<code>%&gt;%</code>). Cú pháp dễ đọc hơn và có những ưu điểm khác đã được giải thích trong cuốn sách này ở chương <a href="cleaning.html#cleaning">Làm sạch số liệu và các hàm quan trọng</a>. Bạn có thể đọc thêm về <em>piping</em> trong phần Piping phía bên dưới.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create new "bmi" column using dplyr syntax</span>
<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>bmi <span class="op">=</span> <span class="va">wt_kg</span> <span class="op">/</span> <span class="op">(</span><span class="va">ht_cm</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="objectstructure" class="section level3" number="3.10.1">
<h3>
<span class="header-section-number">3.10.1</span> Cấu trúc đối tượng<a class="anchor" aria-label="anchor" href="#objectstructure"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Các đối tượng có thể là một phần dữ liệu đơn lẻ (ví dụ: <code>my_number &lt;- 24</code>), hoặc chúng có thể bao gồm dữ liệu có cấu trúc.</strong></p>
<p>Hình ảnh dưới đây được tham khảo từ <a href="http://venus.ifca.unican.es/Rintro/dataStruct.html">hướng dẫn R trực tuyến này</a>. Nó cho thấy một số cấu trúc dữ liệu phổ biến và tên của chúng. Hình ảnh này không bao gồm dữ liệu không gian. Bạn có thể xem thêm về dữ liệu không gian tại chương <a href="data-used.html#gis">GIS cơ bản</a>.</p>
<div class="inline-figure"><img src="images/R_data_structures.png" width="75%" height="50%" style="display: block; margin: auto;"></div>
<p>Trong dịch tễ học (và đặc biệt là dịch tễ học thực địa), bạn sẽ <em>thường xuyên</em> phải tiếp xúc với data frames và vectors:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="11%">
<col width="52%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th>Cấu trúc thường gặ</th>
<th>p | Giái thích</th>
<th>| Ví dụ</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Vectors</td>
<td>Một vùng chứa cho một chuỗi các đối tượng đơn lẻ, tất cả đều thuộc cùng một loại (e.g. số, chữ).</td>
<td>
<strong>“Biến” (Cột) trong dữ liệu là vectors</strong> (ví dụ: cột <code>age_years</code>).</td>
</tr>
<tr class="even">
<td>Data Frames</td>
<td>Vectors (ví dụ: các cột) được liên kết với nhau mà tất cả đều có cùng số hàng. | `linel</td>
<td>ist` là một data frame.</td>
</tr>
</tbody>
</table></div>
<p>Lưu ý rằng để tạo một vectơ “độc lập” (mà không phải là một phần của data frame), hàm <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> được sử dụng để kết hợp các phần tử khác nhau. Ví dụ: nếu tạo một vectơ màu sắc thang màu của biểu đồ: <code>vector_of_colors &lt;- c("blue", "red2", "orange", "grey")</code></p>
<!-- ======================================================= -->
</div>
<div id="kiểu-đối-tượng" class="section level3 unnumbered">
<h3>Kiểu đối tượng<a class="anchor" aria-label="anchor" href="#ki%E1%BB%83u-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng"><i class="fas fa-link"></i></a>
</h3>
<p>Tất cả các đối tượng được lưu trữ trong R đều có một <em>kiểu</em> dữ liệu cho biết cách nó được xử lý. Có nhiều kiểu đối tượng, nhưng những kiểu phổ biến bao gồm:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="3%">
<col width="61%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th>Kiểu</th>
<th>Giải thích</th>
<th>Ví dụ</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Ký tự</td>
<td>Là các chữ/từ/câu được đặt <strong>“trong dấu ngoặc kép”</strong>. Đối tượng kiểu ký tự thì không thể tính toán</td>
<td>“Những ký tự nằm trong dấu ngoặc kép”</td>
</tr>
<tr class="even">
<td>Số nguyên</td>
<td>Các số <strong>nguyên</strong> (không có phần thập phân)</td>
<td>-5, 14, hoặc 2000</td>
</tr>
<tr class="odd">
<td>Số thực</td>
<td>Bao gồm các số nguyên và <strong>có thể bao gồm phần thập phân</strong>. Nếu trong dấu ngoặc kép, chúng sẽ được coi là dạng ký tự</td>
<td>23.1 hoặc 14</td>
</tr>
<tr class="even">
<td>Factor</td>
<td>Đây là các vector có <strong>trật tự xác định</strong> hoặc các giá trị có nhiều danh mục</td>
<td>Biến số của tình trạng kinh tế với các giá trị theo tứ tự</td>
</tr>
<tr class="odd">
<td>Ngày tháng</td>
<td>
<strong>Khi R được thông báo rằng một dữ liệu ở dạng ngày tháng R</strong>, những dữ liệu này có thể được thao tác và hiển thị theo những cách đặc biệt. Xem thêm về biến ngày tháng tại chương <a href="dates.html#dates">Làm việc với ngày tháng</a>.</td>
<td>2018-04-12 hoặc 15/3/1954 hoặc Wed 4 Jan 1980</td>
</tr>
<tr class="even">
<td>Logic</td>
<td>Giá trị của biến chỉ có thể là hai giá trị đặc biệt sau TRUE hoặc FALSE (lưu ý đây <strong>không phải</strong> là “TRUE” và“FALSE” trong dấu ngoặc kép)</td>
<td>TRUE hoặc FALSE</td>
</tr>
<tr class="odd">
<td>data.frame</td>
<td>Một data.frame trong R lưu trữ một <strong>tập dữ liệu điển hình</strong>. Data.frame bao gồm các vector (cột) dữ liệu được liên kết với nhau, tất cả chúng đều có cùng một số lượng quan sát (hàng).</td>
<td>Tập dữ liệu mẫu AJS có tên là <code>linelist_raw</code>chứa 68 biến với 300 quan sát (mỗi hàng)</td>
</tr>
<tr class="even">
<td>tibble</td>
<td>tibbles là một dạng khác của data.frame, sự khác biệt chính là tibble in đẹp hơn trong R console (hiển thị 10 hàng đầu tiên và chỉ các cột vừa với màn hình)</td>
<td>data frame, danh sách, hoặc ma trận có thể chuyển đổi thành tibble bằng hàm <code>as_tibble()</code>
</td>
</tr>
<tr class="odd">
<td>Danh sách</td>
<td>Một danh sách giống như một vector, nhưng chứa các đối tượng có kiểu khác nhau</td>
<td>Một danh sách có thể chứa một số duy nhất, một data.frame, một vector và thậm chí một danh sách khác bên trong nó!</td>
</tr>
</tbody>
</table></div>
<p><strong>Bạn có thể kiểm tra kiểu của một đối tượng bằng cách cung cấp tên của nó tới hàm <code><a href="https://rdrr.io/r/base/class.html">class()</a></code></strong>. Lưu ý: bạn có thể tham chiếu một cột cụ thể trong tập dữ liệu bằng cách sử dụng ký hiệu <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> để phân tách tên của tập dữ liệu và tên của cột.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span>         <span class="co"># class should be a data frame or tibble</span></code></pre></div>
<pre><code>## [1] "data.frame"</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>     <span class="co"># class should be numeric</span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>  <span class="co"># class should be character</span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<p>Đôi khi, một cột sẽ được tự động chuyển đổi thành một kiểu khác bởi R. Hãy coi chừng điều này! Ví dụ: nếu bạn có một vectơ hoặc cột kiểu số, nhưng một giá trị ký tự được chèn vào … thì toàn bộ cột sẽ thay đổi thành kiểu ký tự.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">num_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># define vector as all numbers</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num_vector</span><span class="op">)</span>          <span class="co"># vector is numeric class</span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">num_vector</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"three"</span>   <span class="co"># convert the third element to a character</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num_vector</span><span class="op">)</span>          <span class="co"># vector is now character class</span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<p>Một ví dụ phổ biến của điều này là khi thao tác với một data frame để in bảng - nếu bạn tạo một hàng tính tổng và cố gắng dán /gắn phần trăm với số trong cùng một ô (ví dụ: <code>23 (40%)</code>), toàn bộ cột dạng số ở trên sẽ chuyển đổi thành ký tự và không còn có thể được sử dụng cho các phép tính toán học nữa.</p>
<p><strong>Đôi khi, bạn sẽ cần chuyển đổi các đối tượng hoặc cột sang một loại khác.</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>Hàm</th>
<th>Chức năng</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code></td>
<td>Chuyển sang kiểu ký tự</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code></td>
<td>Chuyển sang kiểu số</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/integer.html">as.integer()</a></code></td>
<td>Chuyển sang kiểu số nguyên</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code></td>
<td>Chuyển sang kiểu ngày tháng - Chú ý: Xem mục <a href="dates.html#dates">Ngày tháng</a> để biết thêm chi tiết</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code></td>
<td>Chuyển sang kiểu factor - Chú ý: nếu muốn định nghĩa lại thứ tự của các giá trị trong biến factor thì cần thêm các đối số bổ sung</td>
</tr>
</tbody>
</table></div>
<p>Tương tự như vậy, một số hàm <strong>base</strong> R có thể kiểm tra xem một đối tượng CÓ thuộc của một kiểu dữ liệu cụ thể nào hay không, chẳng hạn như <code><a href="https://rdrr.io/r/base/numeric.html">is.numeric()</a></code>, <code><a href="https://rdrr.io/r/base/character.html">is.character()</a></code>, <code><a href="https://rdrr.io/r/base/double.html">is.double()</a></code>, <code><a href="https://rdrr.io/r/base/factor.html">is.factor()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html">is.integer()</a></code></p>
<p>Bạn có thể tham khảo <a href="https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/">một tài liệu trực tuyến về các kiểu và cấu trúc dữ liệu trong R</a> tại đây.</p>
<!-- ======================================================= -->
</div>
<div id="cột-biến-số" class="section level3 unnumbered">
<h3>Cột / Biến số (<code>$</code>)<a class="anchor" aria-label="anchor" href="#c%E1%BB%99t-bi%E1%BA%BFn-s%E1%BB%91"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Một cột trong data frame về mặt kỹ thuật là một “vector” (xem bảng ở trên)</strong> - bao gồm một chuỗi các giá trị cùng loại (ký tự, số, lôgic, v.v.).</p>
<p>Một vectơ có thể tồn tại độc lập với một data frame, ví dụ: vectơ tên cột mà bạn muốn đưa vào làm biến giải thích trong mô hình. Để tạo một vectơ “độc lập”, hãy sử dụng hàm <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> như dưới đây:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define the stand-alone vector of character values</span>
<span class="va">explanatory_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"fever"</span>, <span class="st">"chills"</span>, <span class="st">"cough"</span>, <span class="st">"aches"</span>, <span class="st">"vomit"</span><span class="op">)</span>

<span class="co"># print the values in this named vector</span>
<span class="va">explanatory_vars</span></code></pre></div>
<pre><code>## [1] "gender" "fever"  "chills" "cough"  "aches"  "vomit"</code></pre>
<p><strong>Các cột trong data frame cũng là vectơ và có thể được gọi, tham chiếu, trích xuất hoặc tạo bằng ký hiệu <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code>.</strong> Ký hiệu <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> kết nối tên của cột với tên của data frame tương ứng. Trong cuốn sách này, chúng tôi cố gắng sử dụng từ “cột” thay vì “biến số”.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retrieve the length of the vector age_years</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="co"># (age is a column in the linelist data frame)</span></code></pre></div>
<p>Bằng cách nhập tên của một dataframe, theo sau bởi ký tự <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code>, bạn sẽ thấy menu gợi ý của tất cả các tên cột trong dataframe. Bạn có thể di chuyển giữa các cột bằng phím mũi tên, chọn cột bằng phím Enter để tránh lỗi chính tả!</p>
<div class="inline-figure"><img src="images/Calling_Names.gif" width="100%" style="display: block; margin: auto;"></div>
<p><span style="color: darkgreen;"><strong><em>MẸO NÂNG CAO:</em></strong> Một số đối tượng phức tạp hơn (ví dụ: một danh sách hoặc đối tượng <code>epicontacts</code>) có thể có nhiều cấp độ có thể được truy cập thông qua nhiều ký tự đô la. Ví dụ: <code>epicontacts$linelist$date_onset</code></span></p>
<!-- ======================================================= -->
</div>
<div id="truy-cập-indexing-đối-tượng-bằng-dấu-ngoặc-vuông" class="section level3 unnumbered">
<h3>Truy cập / indexing đối tượng bằng dấu ngoặc vuông (<code>[ ]</code>)<a class="anchor" aria-label="anchor" href="#truy-c%E1%BA%ADp-indexing-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-b%E1%BA%B1ng-d%E1%BA%A5u-ngo%E1%BA%B7c-vu%C3%B4ng"><i class="fas fa-link"></i></a>
</h3>
<p>Khi cần xem một phần của đối tượng, còn được gọi là “indexing”, bạn có thể sử dụng dấu ngoặc vuông <code>[ ]</code>. Sử dụng <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> trên dataframe để truy cập một cột cũng là một kiểu indexing.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span>  <span class="co"># define the vector</span>
<span class="va">my_vector</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>                                  <span class="co"># print the 5th element</span></code></pre></div>
<pre><code>## [1] "e"</code></pre>
<p>Dấu ngoặc vuông cũng hoạt động để xem các phần cụ thể trong kết quả đầu ra, chẳng hạn như đầu ra của hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># All of the summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    6.00   13.00   16.07   23.00   84.00      86</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Just the second element of the summary, with name (using only single brackets)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>## 1st Qu. 
##       6</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Just the second element, without name (using double brackets)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract an element by name, without showing the name</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">[[</span><span class="st">"Median"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p>Dấu ngoặc vuông cũng hoạt động trên data frames để xem các hàng và cột cụ thể. Bạn có thể thực hiện việc này bằng cú pháp <code>dataframe[rows, columns]</code>:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View a specific row (2) from dataset, with all columns (don't forget the comma!)</span>
<span class="va">linelist</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>

<span class="co"># View all rows, but just one column</span>
<span class="va">linelist</span><span class="op">[</span>, <span class="st">"date_onset"</span><span class="op">]</span>

<span class="co"># View values from row 2 and columns 5 through 10</span>
<span class="va">linelist</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> 

<span class="co"># View values from row 2 and columns 5 through 10 and 18</span>
<span class="va">linelist</span><span class="op">[</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">18</span><span class="op">)</span><span class="op">]</span> 

<span class="co"># View rows 2 through 20, and specific columns</span>
<span class="va">linelist</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"outcome"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># View rows and columns based on criteria</span>
<span class="co"># *** Note the dataframe must still be named in the criteria!</span>
<span class="va">linelist</span><span class="op">[</span><span class="va">linelist</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">25</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date_onset"</span>, <span class="st">"outcome"</span>, <span class="st">"age"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Use View() to see the outputs in the RStudio Viewer pane (easier to read) </span>
<span class="co"># *** Note the capital "V" in View() function</span>
<span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, <span class="st">"date_onset"</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Save as a new object</span>
<span class="va">new_table</span> <span class="op">&lt;-</span> <span class="va">linelist</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date_onset"</span><span class="op">)</span><span class="op">]</span> </code></pre></div>
<p>Lưu ý rằng bạn cũng có thể indexing hàng / cột trong một data frames và tibbles bằng cách sử dụng cú pháp của package <strong>dplyr</strong> (hàm <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> đối với hàng, và <code>select()</code> đối với cột). Đọc thêm về các hàm quan trọng này trong chương <a href="cleaning.html#cleaning">Làm sạch số liệu và các hàm quan trọng</a>.</p>
<p>Để lọc dựa trên “số thứ tự hàng”, bạn có thể sử dụng hàm <code>row_number()</code>trong package <strong>dplyr</strong> với dấu ngoặc đơn mở như một phần của biểu thức lọc logic. Thường thì bạn sẽ sử dụng toán tử <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> và một khoảng giá trị số như một phần của câu lệnh logic đó, như được trình bày dưới đây. Để xem N hàng <em>đầu tiên</em>, bạn cũng có thể sử dụng hàm <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> của package <strong>dplyr</strong>.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># View first 100 rows</span>
<span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>

<span class="co"># Show row 5 only</span>
<span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># View rows 2 through 20, and three specific columns (note no quotes necessary on column names)</span>
<span class="va">linelist</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span> <span class="op">%in%</span> <span class="fl">2</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">date_onset</span>, <span class="va">outcome</span>, <span class="va">age</span><span class="op">)</span></code></pre></div>
<p>Khi indexing một đối tượng chứa một <strong>danh sách</strong> bằng một dấu ngoặc vuông sẽ luôn trả về kiểu danh sách, ngay cả khi chỉ một đối tượng được trả về . Tuy nhiên, hai dấu ngoặc vuông có thể được sử dụng để truy cập một phần tử đơn lẻ đối và trả về một kiểu không phải là một danh sách.<br>
Dấu ngoặc vuông cũng có thể được viết sau nhau, như được minh họa bên dưới.</p>
<p>Bạn có thể xem một <a href="https://r4ds.had.co.nz/vectors.html#lists-of-condiments">giải thích trực quan về việc indexing với ví dụ về hộp lắc hạt tiêu</a> tại đây, rất hài hước và hữu ích.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define demo list</span>
<span class="va">my_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="co"># First element in the list is a character vector</span>
  hospitals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Central"</span>, <span class="st">"Empire"</span>, <span class="st">"Santa Anna"</span><span class="op">)</span>,
  
  <span class="co"># second element in the list is a data frame of addresses</span>
  addresses   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    street <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"145 Medical Way"</span>, <span class="st">"1048 Brown Ave"</span>, <span class="st">"999 El Camino"</span><span class="op">)</span>,
    city   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Andover"</span>, <span class="st">"Hamilton"</span>, <span class="st">"El Paso"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Đây là cách mà một danh sách được in trong R console. Có hai phần tử được đặt tên:</p>
<ul>
<li>
<code>hospitals</code>, một vector chứa ký tự<br>
</li>
<li>
<code>addresses</code>, một data frame chứa các địa chỉ</li>
</ul>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span></code></pre></div>
<pre><code>## $hospitals
## [1] "Central"    "Empire"     "Santa Anna"
## 
## $addresses
##            street     city
## 1 145 Medical Way  Andover
## 2  1048 Brown Ave Hamilton
## 3   999 El Camino  El Paso</code></pre>
<p>Dưới đây là các phương pháp indexing mà bạn có thể sử dụng:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># this returns the element in class "list" - the element name is still displayed</span></code></pre></div>
<pre><code>## $hospitals
## [1] "Central"    "Empire"     "Santa Anna"</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># this returns only the (unnamed) character vector</span></code></pre></div>
<pre><code>## [1] "Central"    "Empire"     "Santa Anna"</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span><span class="op">[[</span><span class="st">"hospitals"</span><span class="op">]</span><span class="op">]</span> <span class="co"># you can also index by name of the list element</span></code></pre></div>
<pre><code>## [1] "Central"    "Empire"     "Santa Anna"</code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co"># this returns the third element of the "hospitals" character vector</span></code></pre></div>
<pre><code>## [1] "Santa Anna"</code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># This returns the first column ("street") of the address data frame</span></code></pre></div>
<pre><code>##            street
## 1 145 Medical Way
## 2  1048 Brown Ave
## 3   999 El Camino</code></pre>
<!-- ======================================================= -->
</div>
<div id="xóa-đối-tượng" class="section level3 unnumbered">
<h3>Xóa đối tượng<a class="anchor" aria-label="anchor" href="#x%C3%B3a-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng"><i class="fas fa-link"></i></a>
</h3>
<p>Bạn có thể xóa từng đối tượng riêng lẻ khỏi cửa sổ R environment bằng cách để tên của đối tượng cần xóa vào trong hàm <code><a href="https://rdrr.io/r/base/rm.html">rm()</a></code> (không có dấu ngoặc kép):</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">object_name</span><span class="op">)</span></code></pre></div>
<p>Bạn có thể xóa tất cả các đối tượng (xóa không gian làm việc của bạn) bằng cách chạy:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
<div id="piping" class="section level2" number="3.11">
<h2>
<span class="header-section-number">3.11</span> Piping (<code>%&gt;%</code>)<a class="anchor" aria-label="anchor" href="#piping"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Hai cách tiếp cận chung để làm việc với các đối tượng là:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Pipes/tidyverse</strong> - pipes chuyển một đối tượng từ hàm này sang hàm khác - tập trung vào <em>hành động</em> chứ không phải đối tượng<br>
</li>
<li>
<strong>Xác định đối tượng trung gian</strong> - một đối tượng được xác định lại nhiều lần - tập trung vào đối tượng</li>
</ol>
<!-- ======================================================= --><div id="pipes" class="section level3 unnumbered">
<h3>
<strong>Pipes</strong><a class="anchor" aria-label="anchor" href="#pipes"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Giải thích một cách đơn giản, toán tử pipe (<code>%&gt;%</code>) chuyển một đầu ra trung gian từ hàm này sang hàm tiếp theo.</strong><br>
Hiểu đơn giản pipe nghĩa là “sau đó”. Nhiều hàm có thể được liên kết với nhau bằng toán tử <code>%&gt;%</code>.</p>
<ul>
<li>
<strong>Piping nhấn mạnh một chuỗi các hành động, không phải đối tượng mà các hành động đang áp dụng</strong><br>
</li>
<li>Pipes được áp dụng tốt nhất khi một chuỗi hành động phải được thực hiện trên một đối tượng<br>
</li>
<li>Pipes đến từ package <strong>magrittr</strong>, và đã tự động được thêm vào packages <strong>dplyr</strong> và <strong>tidyverse</strong>
</li>
<li>Pipes làm cho code sạch hơn, dễ đọc hơn và trực quan hơn</li>
</ul>
<p>Đọc thêm về cách tiếp cận này trong package tidyverse tại đây <a href="https://style.tidyverse.org/pipes.html">Hướng dẫn</a></p>
<p>Đây là một ví dụ mô phỏng dùng để so sánh, sử dụng các hàm hư cấu để “nướng bánh”. Đầu tiên, phương pháp pipe:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A fake example of how to bake a cake using piping syntax</span>

<span class="va">cake</span> <span class="op">&lt;-</span> <span class="va">flour</span> <span class="op">%&gt;%</span>       <span class="co"># to define cake, start with flour, and then...</span>
  <span class="fu">add</span><span class="op">(</span><span class="va">eggs</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># add eggs</span>
  <span class="fu">add</span><span class="op">(</span><span class="va">oil</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co"># add oil</span>
  <span class="fu">add</span><span class="op">(</span><span class="va">water</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># add water</span>
  <span class="fu">mix_together</span><span class="op">(</span>         <span class="co"># mix together</span>
    utensil <span class="op">=</span> <span class="va">spoon</span>,
    minutes <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>    
  <span class="fu">bake</span><span class="op">(</span>degrees <span class="op">=</span> <span class="fl">350</span>,   <span class="co"># bake</span>
       system <span class="op">=</span> <span class="st">"fahrenheit"</span>,
       minutes <span class="op">=</span> <span class="fl">35</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu">let_cool</span><span class="op">(</span><span class="op">)</span>            <span class="co"># let it cool down</span></code></pre></div>
<p>Đây là một <a href="https://cfss.uchicago.edu/notes/pipes/#:~:text=Pipes%20are%20an%20extremely%20useful,code%20and%20combine%20multiple%20operations">link</a> khác mô tả công dụng của pipe.</p>
<p>Piping không phải là một hàm trong <strong>base</strong> R. Để sử dụng piping, package <strong>magrittr</strong> phải được cài đặt và gọi ra trong phiên làm việc hiện tại (điều này thường được thực hiện bằng cách gọi package <strong>tidyverse</strong> hoặc <strong>dplyr</strong>). Bạn có thể <a href="https://magrittr.tidyverse.org/">đọc thêm về piping trong tài liệu magrittr</a>.</p>
<p>Lưu ý rằng cũng giống như các lệnh R khác, các pipes có thể được sử dụng để hiển thị kết quả hoặc lưu/lưu lại một đối tượng, tùy thuộc vào toán tử <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code> được code như thế nào. Xem hai ví dụ dưới đây:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create or overwrite object, defining as aggregate counts by age category (not printed)</span>
<span class="va">linelist_summary</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">count</span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print the table of counts in the console, but don't save it</span>
<span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">count</span><span class="op">(</span><span class="va">age_cat</span><span class="op">)</span></code></pre></div>
<pre><code>##   age_cat    n
## 1     0-4 1095
## 2     5-9 1095
## 3   10-14  941
## 4   15-19  743
## 5   20-29 1073
## 6   30-49  754
## 7   50-69   95
## 8     70+    6
## 9    &lt;NA&gt;   86</code></pre>
<p><strong><code>%&lt;&gt;%</code></strong><br></p>
<p>Đây là một “assignment pipe (pipe dùng để gán)” từ package <strong>magrittr</strong>, package này sẽ <em>pipe một đối tượng theo chiều tiến lên và cũng tái định nghĩa lại đối tượng</em>. Đối tượng cần đứng đầu trong chuỗi pipe. Nó nhanh hơn sử dụng pipe thông thường. Hai lệnh dưới đây là tương đương với nhau:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span>

<span class="va">linelist</span> <span class="op">%&lt;&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="định-nghĩa-đối-tượng-trung-gian" class="section level3 unnumbered">
<h3>Định nghĩa đối tượng trung gian<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%8Bnh-ngh%C4%A9a-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-trung-gian"><i class="fas fa-link"></i></a>
</h3>
<p>Cách tiếp cận này dùng để thay đổi đối tượng/dataframes sẽ phát huy hiệu quả nếu:</p>
<ul>
<li>Bạn cần thao tác trên nhiều đối tượng<br>
</li>
<li>Các bước trung gian có ý nghĩa cụ thể và xứng đáng tạo các tên đối tượng riêng biệt</li>
</ul>
<p><strong>Các nguy cơ:</strong></p>
<ul>
<li>Tạo đối tượng mới cho mỗi bước có nghĩa là bạn sẽ tạo thêm rất nhiều đối tượng. Nếu bạn sử dụng không cẩn thận, bạn có thể dễ dàng bị nhầm lẫn!<br>
</li>
<li>Đặt thêm nhiều tên cho nhiều đối tượng có thể gây nhầm lẫn<br>
</li>
<li>Nếu có lỗi thì không dễ để phát hiện</li>
</ul>
<p>Đặt tên cho từng đối tượng trung gian hoặc ghi đè lên đối tượng gốc hoặc kết hợp tất cả hàm với nhau đều đi kèm với những rủi ro.</p>
<p>Dưới đây vẫn là ví dụ mô phỏng quy trình làm “bánh” tương tự như trên, nhưng sử dụng phong cách này:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a fake example of how to bake a cake using this method (defining intermediate objects)</span>
<span class="va">batter_1</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">flour</span>, <span class="va">eggs</span><span class="op">)</span>
<span class="va">batter_2</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">batter_1</span>, <span class="va">oil</span><span class="op">)</span>
<span class="va">batter_3</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">batter_2</span>, <span class="va">water</span><span class="op">)</span>

<span class="va">batter_4</span> <span class="op">&lt;-</span> <span class="fu">mix_together</span><span class="op">(</span>object <span class="op">=</span> <span class="va">batter_3</span>, utensil <span class="op">=</span> <span class="va">spoon</span>, minutes <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">batter_4</span>, degrees <span class="op">=</span> <span class="fl">350</span>, system <span class="op">=</span> <span class="st">"fahrenheit"</span>, minutes <span class="op">=</span> <span class="fl">35</span><span class="op">)</span>

<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">let_cool</span><span class="op">(</span><span class="va">cake</span><span class="op">)</span></code></pre></div>
<p>Kết hợp tất cả các hàm với nhau - câu lệnh rất khó đọc:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># an example of combining/nesting mutliple functions together - difficult to read</span>
<span class="va">cake</span> <span class="op">&lt;-</span> <span class="fu">let_cool</span><span class="op">(</span><span class="fu">bake</span><span class="op">(</span><span class="fu">mix_together</span><span class="op">(</span><span class="va">batter_3</span>, utensil <span class="op">=</span> <span class="va">spoon</span>, minutes <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, degrees <span class="op">=</span> <span class="fl">350</span>, system <span class="op">=</span> <span class="st">"fahrenheit"</span>, minutes <span class="op">=</span> <span class="fl">35</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="operators" class="section level2" number="3.12">
<h2>
<span class="header-section-number">3.12</span> Các toán tử và hàm chính<a class="anchor" aria-label="anchor" href="#operators"><i class="fas fa-link"></i></a>
</h2>
<p>Mục này sẽ trình bày chi tiết các toán tử trong R, chẳng hạn như :</p>
<ul>
<li>Toán tử định nghĩa<br>
</li>
<li>Toán tử quan hệ (nhỏ hơn, bằng nhau..)<br>
</li>
<li>Toán tử logic (và, hoặc..)<br>
</li>
<li>Xử lý missing<br>
</li>
<li>Các toán tử và hàm toán học (+/-, &gt;, sum(), median(), …)<br>
</li>
<li>Toán tử <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code>
</li>
</ul>
<!-- ======================================================= --><div id="toán-tử-gán" class="section level3 unnumbered">
<h3>Toán tử gán<a class="anchor" aria-label="anchor" href="#to%C3%A1n-t%E1%BB%AD-g%C3%A1n"><i class="fas fa-link"></i></a>
</h3>
<p><strong><code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code></strong></p>
<p>Toán tử gán cơ bản trong R là <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>. Chẳng hạn như <code>object_name &lt;- value</code>.<br>
Toán tử gán này cũng có thể được viết là <code><a href="https://rdrr.io/r/base/assignOps.html">=</a></code>. Chúng tôi khuyên bạn nên sử dụng <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>.<br>
Bạn nên sử dụng dấu cách trong khi viết code với toán tử gán để dễ đọc hơn.</p>
<p><strong><code><a href="https://rdrr.io/r/base/assignOps.html">&lt;&lt;-</a></code></strong></p>
<p>Khi <a href="writing-functions.html#writing-functions">Viết hàm</a>, hoặc khi sử dụng R với scipt nguồn, thì bạn có thể cần sử dụng toán tử gán này <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;&lt;-</a></code> (từ <strong>base</strong> R). Toán tử này được sử dụng để định nghĩa một đối tượng trong một hàm lồng trong một hàm khác. Xem thêm tại <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/assignOps.html">nguồn tham khảo online này</a>.</p>
<p><strong><code>%&lt;&gt;%</code></strong></p>
<p>Đây là một “pipe gán” từ package <strong>magrittr</strong>, package này sẽ <em>gán một đối tượng theo chiều tiến lên và cũng định nghĩa lại đối tượng</em>. Pipe gán phải là toán tử đầu tiên trong chuỗi pipe code. Đây là cách viết ngắn gọn, như được trình bày dưới đây là hai ví dụ tương đương với nhau:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>age_months <span class="op">=</span> <span class="va">age_years</span> <span class="op">*</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p>Đoạn code bên trên tương đương với code dưới đây:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist</span> <span class="op">%&lt;&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>age_months <span class="op">=</span> <span class="va">age_years</span> <span class="op">*</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p><strong><code>%&lt;+%</code></strong></p>
<p>Toán tử này được sử dụng dể thêm dữ liệu vào Cây phả hệ với package <strong>ggtree</strong>. Xem thêm chương <a href="phylogenetic-trees.html#phylogenetic-trees">Cây phả hệ</a> hoặc <a href="https://yulab-smu.top/treedata-book/">Sách online này</a>.</p>
<!-- ======================================================= -->
</div>
<div id="toán-tử-quan-hệ-và-logic" class="section level3 unnumbered">
<h3>Toán tử quan hệ và logic<a class="anchor" aria-label="anchor" href="#to%C3%A1n-t%E1%BB%AD-quan-h%E1%BB%87-v%C3%A0-logic"><i class="fas fa-link"></i></a>
</h3>
<p>Toán tử quan hệ so sánh các giá trị và thường được sử dụng khi định nghĩa các biến mới và tập con của bộ dữ liệu. Dưới đây là các toán tử quan hệ phổ biến trong R:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="11%">
<col width="6%">
<col width="7%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Ý nghĩa</th>
<th>Toán tử</th>
<th>Ví dụ</th>
<th>Kết quả đầu ra của ví dụ</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Bằng</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code></td>
<td><code>"A" == "a"</code></td>
<td>
<code>FALSE</code> (vì R phân biệt chữ hoa chữ thường) Lưu ý rằng <em>== (hai dấu bằng) khác với = (một dấu bằng), một dấu bằng hoạt động tương tự với toán tử gán <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code></em>
</td>
</tr>
<tr class="even">
<td>Không bằng</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">!=</a></code></td>
<td><code>2 != 0</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="odd">
<td>Lớn hơn</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code></td>
<td><code>4 &gt; 2</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>Nhỏ hơn</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code></td>
<td><code>4 &lt; 2</code></td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td>Lớn hơn hoặc bằng</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">&gt;=</a></code></td>
<td><code>6 &gt;= 4</code></td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>Nhỏ hơn hoặc bằng</td>
<td><code><a href="https://rdrr.io/r/base/Comparison.html">&lt;=</a></code></td>
<td><code>6 &lt;= 4</code></td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td>Giá trị bị missing</td>
<td><code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code></td>
<td><code><a href="https://rdrr.io/r/base/NA.html">is.na(7)</a></code></td>
<td>
<code>FALSE</code> (Xem thêm chương <a href="missing-data.html#missing-data">Dữ liệu Missing</a>)</td>
</tr>
<tr class="even">
<td>Giá trị không missing</td>
<td><code>!is.na()</code></td>
<td><code>!is.na(7)</code></td>
<td><code>TRUE</code></td>
</tr>
</tbody>
</table></div>
<p>Các toán tử logic, chẳng hạn như AND và OR, thường được sử dụng để kết nối các quan hệ và tạo ra các điều kiện phức tạp hơn. Các biểu thức phức tạp có thể yêu cầu dấu ngoặc đơn () để phân nhóm và thứ tự áp dụng.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th>Ý nghĩa</th>
<th>Toán tử</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>AND</td>
<td><code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code></td>
</tr>
<tr class="even">
<td>OR</td>
<td>
<code><a href="https://rdrr.io/r/base/Logic.html">|</a></code> (thanh dọc)</td>
</tr>
<tr class="odd">
<td>Dấu ngoặc đơn</td>
<td>
<code>( )</code> Được sử dụng để nhóm các tiêu chí lại với nhau và làm rõ thứ tự hoạt động</td>
</tr>
</tbody>
</table></div>
<p>Ví dụ: chúng ta có một số liệu có tên linelist với hai biến mà chúng tôi muốn sử dụng để minh họa, <code>hep_e_rdt</code>: kết quả xét nghiệm và <code>other_cases_in_hh</code>: những trường hợp khác trong gia đình. Lệnh dưới đây sử dụng hàm <code>case_when()</code> để tạo biến mới <code>case_def</code> như sau:</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linelist_cleaned</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>case_def <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">rdt_result</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">other_case_in_home</span><span class="op">)</span>            <span class="op">~</span> <span class="cn">NA_character_</span>,
    <span class="va">rdt_result</span> <span class="op">==</span> <span class="st">"Positive"</span>                                 <span class="op">~</span> <span class="st">"Confirmed"</span>,
    <span class="va">rdt_result</span> <span class="op">!=</span> <span class="st">"Positive"</span> <span class="op">&amp;</span> <span class="va">other_cases_in_home</span> <span class="op">==</span> <span class="st">"Yes"</span>  <span class="op">~</span> <span class="st">"Probable"</span>,
    <span class="cn">TRUE</span>                                                     <span class="op">~</span> <span class="st">"Suspected"</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="70%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th>Điều kiện trong ví dụ ở trên</th>
<th>Giá trị kết quả trong biến mới “case_def”</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Nếu giá trị của biến <code>rdt_result</code> và <code>other_cases_in_home</code> bị missing</td>
<td>
<code>NA</code> (missing)</td>
</tr>
<tr class="even">
<td>Nếu giá trị trong <code>rdt_result</code> là “Positive”</td>
<td>“Confirmed”</td>
</tr>
<tr class="odd">
<td>Nếu giá trị trong <code>rdt_result</code> KHÔNG phải là “Positive” VÀ giá trị trong <code>other_cases_in_home</code> là “Yes”</td>
<td>“Probable”</td>
</tr>
<tr class="even">
<td>Nếu một trong các tiêu chí trên không được đáp ứng</td>
<td>“Suspected”</td>
</tr>
</tbody>
</table></div>
<p>Lưu ý rằng R có phân biệt chữ hoa chữ thường, vì vậy <em>“Positive” khác với “positive”…</em></p>
<!-- ======================================================= -->
</div>
<div id="giá-trị-missing" class="section level3 unnumbered">
<h3>Giá trị Missing<a class="anchor" aria-label="anchor" href="#gi%C3%A1-tr%E1%BB%8B-missing"><i class="fas fa-link"></i></a>
</h3>
<p>Trong R, giá trị missing được biểu diễn bằng giá trị đặc biệt <code>NA</code> (giá trị “dành riêng cho missing”) (chữ N và A viết hoa - không nằm trong dấu ngoặc kép). Nếu dữ liệu bạn nhập vào R bị missing theo cách khác (ví dụ: 99, “Missing”, or .), bạn có thể sẽ cần phải mã hóa lại các giá trị đó thành <code>NA</code>. Cách thực hiện việc này được đề cập trong chương <a href="importing.html#importing">Nhập xuất dữ liệu</a>.</p>
<p><strong>Để kiểm tra xem một giá trị có phải là <code>NA</code> hay không, sử dụng hàm đặc biệt <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code></strong>, kết quả sẽ trả về <code>TRUE</code> hoặc <code>FALSE</code>.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rdt_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Suspected"</span>, <span class="st">"Positive"</span>, <span class="cn">NA</span><span class="op">)</span>   <span class="co"># two positive cases, one suspected, and one unknown</span>
<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">rdt_result</span><span class="op">)</span>  <span class="co"># Tests whether the value of rdt_result is NA</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE</code></pre>
<p>Đọc thêm về missing, vô hạn, <code>NULL</code>, và các giá trị không thể trong chương <a href="missing-data.html#missing-data">Dữ liệu Missing</a>. Tìm hiểu thêm cách chuyển đổi các giá trị bị missing khi nhập dữ liệu trong chương <a href="importing.html#importing">Nhập xuất dữ liệu</a>.</p>
<!-- ======================================================= -->
</div>
<div id="toán-học-và-thống-kê" class="section level3" number="3.12.1">
<h3>
<span class="header-section-number">3.12.1</span> Toán học và thống kê<a class="anchor" aria-label="anchor" href="#to%C3%A1n-h%E1%BB%8Dc-v%C3%A0-th%E1%BB%91ng-k%C3%AA"><i class="fas fa-link"></i></a>
</h3>
<p>{.unnumbered}</p>
<p>Tất cả các toán tử và hàm trong chương này đều có sẵn bằng cách sử dụng <strong>base</strong> R.</p>
<div id="toán-tử-toán-học" class="section level4 unnumbered">
<h4>Toán tử toán học<a class="anchor" aria-label="anchor" href="#to%C3%A1n-t%E1%BB%AD-to%C3%A1n-h%E1%BB%8Dc"><i class="fas fa-link"></i></a>
</h4>
<p>Chúng thường được sử dụng để thực hiện phép cộng, phép chia, để tạo cột mới, v.v. Dưới đây là các toán tử toán học phổ biến trong R. Việc bạn có đặt dấu cách xung quanh các toán tử hay không là không quan trọng.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Mục đích</th>
<th>Ví dụ trong R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>phép cộng</td>
<td>2 + 3</td>
</tr>
<tr class="even">
<td>phép trừ</td>
<td>2 - 3</td>
</tr>
<tr class="odd">
<td>phép nhân</td>
<td>2 * 3</td>
</tr>
<tr class="even">
<td>phép chia</td>
<td>30 / 5</td>
</tr>
<tr class="odd">
<td>số mũ</td>
<td>2^3</td>
</tr>
<tr class="even">
<td>thứ tự hoạt động</td>
<td>( )</td>
</tr>
</tbody>
</table></div>
</div>
<div id="các-hàm-toán-học" class="section level4 unnumbered">
<h4>Các hàm toán học<a class="anchor" aria-label="anchor" href="#c%C3%A1c-h%C3%A0m-to%C3%A1n-h%E1%BB%8Dc"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Mục tiêu</th>
<th>Hàm</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>làm tròn</td>
<td>round(x, digits = n)</td>
</tr>
<tr class="even">
<td>làm tròn</td>
<td>janitor::round_half_up(x, digits = n)</td>
</tr>
<tr class="odd">
<td>làm tròn lên</td>
<td>ceiling(x)</td>
</tr>
<tr class="even">
<td>làm tròn xuống</td>
<td>floor(x)</td>
</tr>
<tr class="odd">
<td>giá trị tuyệt đối</td>
<td>abs(x)</td>
</tr>
<tr class="even">
<td>căn bậc hai</td>
<td>sqrt(x)</td>
</tr>
<tr class="odd">
<td>số mũ</td>
<td>exponent(x)</td>
</tr>
<tr class="even">
<td>logarit tự nhiên</td>
<td>log(x)</td>
</tr>
<tr class="odd">
<td>logarit cơ số 10</td>
<td>log10(x)</td>
</tr>
<tr class="even">
<td>logarit cơ số 2</td>
<td>log2(x)</td>
</tr>
</tbody>
</table></div>
<p>lưu ý: sử dụng hàm <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> và <code>digits =</code> để xác định số chữ số thập phân được hiển thị. Sử dụng hàm <code><a href="https://rdrr.io/r/base/Round.html">signif()</a></code> để làm tròn đến số chữ số nhất định.</p>
</div>
<div id="ký-hiệu-khoa-học" class="section level4 unnumbered">
<h4>Ký hiệu khoa học<a class="anchor" aria-label="anchor" href="#k%C3%BD-hi%E1%BB%87u-khoa-h%E1%BB%8Dc"><i class="fas fa-link"></i></a>
</h4>
<p>Khả năng ký hiệu khoa học được sử dụng phụ thuộc vào giá trị của <code>scipen</code>.</p>
<p>Từ tài liệu hướng dẫn của <code><a href="https://rdrr.io/r/base/options.html">?options</a></code>: scipen được áp dụng khi quyết định in các giá trị số theo ký hiệu cố định hoặc hàm mũ. Giá trị dương thuộc về ký hiệu cố định còn giá trị âm thuộc về ký hiệu khoa học: ký hiệu cố định sẽ luôn được ưu tiên trừ khi có nhiều chữ số ‘scipen’.</p>
<p>Nếu như có rất nhiều số bé cần hiển thị (vd: số 0), mặc định tính năng này sẽ “được bật”. Để “tắt” tính năng ký hiệu khoa học trong phiên làm việc của bạn, hãy thiết lập nó với một số rất lớn, ví dụ:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># turn off scientific notation</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen<span class="op">=</span><span class="fl">999</span><span class="op">)</span></code></pre></div>
</div>
<div id="làm-tròn" class="section level4 unnumbered">
<h4>Làm tròn<a class="anchor" aria-label="anchor" href="#l%C3%A0m-tr%C3%B2n"><i class="fas fa-link"></i></a>
</h4>
<p><span style="color: red;"><strong><em>NGUY HIỂM:</em></strong> Hàm <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> sử dụng “cách làm tròn của ngân hàng” nghĩa là chỉ làm tròn với số .5 nếu số được làm tròn lên là số chẵn. Sử dụng hàm <code>round_half_up()</code> từ package <strong>janitor</strong> để thống nhất cách làm tròn với giá trị .5. Xem thêm <a href="https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html#explore-records-with-duplicated-values-for-specific-combinations-of-variables-with-get_dupes">giải thích sau đây</a></span></p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use the appropriate rounding function for your work</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2 4</code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/round_half_up.html">round_half_up</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">3.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3 4</code></pre>
</div>
<div id="các-hàm-thống-kê" class="section level4 unnumbered">
<h4>Các hàm thống kê<a class="anchor" aria-label="anchor" href="#c%C3%A1c-h%C3%A0m-th%E1%BB%91ng-k%C3%AA"><i class="fas fa-link"></i></a>
</h4>
<p><span style="color: orange;"><strong><em>CẨN TRỌNG:</em></strong> Các hàm sau đây sẽ mặc định bao gồm cả giá trị missing khi tính toán. Giá trị missing sẽ trả về kết quả đầu ra chứa <code>NA</code>, trừ khi đối số <code>na.rm = TRUE</code> được xác định khi viết hàm. Nó cũng có thể viết ngắn gọn thành <code>na.rm = T</code>.</span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Mục đích</th>
<th>Hàm</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>trung bình</td>
<td>mean(x, na.rm=T)</td>
</tr>
<tr class="even">
<td>trung vị</td>
<td>median(x, na.rm=T)</td>
</tr>
<tr class="odd">
<td>độ lệch chuẩn</td>
<td>sd(x, na.rm=T)</td>
</tr>
<tr class="even">
<td>phân vị*</td>
<td>quantile(x, probs)</td>
</tr>
<tr class="odd">
<td>tổng</td>
<td>sum(x, na.rm=T)</td>
</tr>
<tr class="even">
<td>giá trị nhỏ nhất</td>
<td>min(x, na.rm=T)</td>
</tr>
<tr class="odd">
<td>giá trị lớn nhất</td>
<td>max(x, na.rm=T)</td>
</tr>
<tr class="even">
<td>khoảng giá trị số</td>
<td>range(x, na.rm=T)</td>
</tr>
<tr class="odd">
<td>tóm tắt**</td>
<td>summary(x)</td>
</tr>
</tbody>
</table></div>
<p>Notes:</p>
<ul>
<li>
<code>*quantile()</code>: <code>x</code> là vectơ số cần khảo sát, và <code>probs =</code> là một vectơ số với các xác suất nằm giữa 0 và 1.0, ví dụ <code><a href="https://rdrr.io/r/base/c.html">c(0.5, 0.8, 0.85)</a></code>
</li>
<li>
<code>**summary()</code>: trả về tóm tắt một vectơ số bao gồm giá trị trung bình, trung vị, và các khoảng phân vị thường gặp</li>
</ul>
<p><span style="color: red;"><strong><em>NGUY HIỂM:</em></strong> Nếu cung cấp một vectơ số cho một trong các hàm trên, hãy đảm bảo các số được đặt trong hàm <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> .</span></p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If supplying raw numbers to a function, wrap them in c()</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span>    <span class="co"># !!! INCORRECT !!!  </span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co"># CORRECT</span></code></pre></div>
<pre><code>## [1] 5.666667</code></pre>
</div>
<div id="một-số-hàm-hữu-ích-khác" class="section level4 unnumbered">
<h4>Một số hàm hữu ích khác<a class="anchor" aria-label="anchor" href="#m%E1%BB%99t-s%E1%BB%91-h%C3%A0m-h%E1%BB%AFu-%C3%ADch-kh%C3%A1c"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="26%">
<col width="21%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Mục đích</th>
<th>Hàm</th>
<th>Ví dụ</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Tạo chuỗi số liên tục</td>
<td>seq(from, to, by)</td>
<td><code><a href="https://rdrr.io/r/base/seq.html">seq(1, 10, 2)</a></code></td>
</tr>
<tr class="even">
<td>lặp x, n lần</td>
<td>rep(x, ntimes)</td>
<td>
<code><a href="https://rdrr.io/r/base/rep.html">rep(1:3, 2)</a></code> or <code><a href="https://rdrr.io/r/base/rep.html">rep(c("a", "b", "c"), 3)</a></code>
</td>
</tr>
<tr class="odd">
<td>chia nhỏ một vectơ số</td>
<td>cut(x, n)</td>
<td><code><a href="https://rdrr.io/r/base/cut.html">cut(linelist$age, 5)</a></code></td>
</tr>
<tr class="even">
<td>lấy một mẫu ngẫu nhiên</td>
<td>sample(x, size)</td>
<td><code><a href="https://rdrr.io/r/base/sample.html">sample(linelist$id, size = 5, replace = TRUE)</a></code></td>
</tr>
</tbody>
</table></div>
<!-- ======================================================= -->
</div>
</div>
<div id="in" class="section level3 unnumbered">
<h3>
<code>%in%</code><a class="anchor" aria-label="anchor" href="#in"><i class="fas fa-link"></i></a>
</h3>
<p>Một toán tử rất hữu ích để nhanh chóng đánh giá xem một giá trị có nằm trong một vectơ hoặc một dataframe hay không.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"a"</span> <span class="op">%in%</span> <span class="va">my_vector</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="st">"h"</span> <span class="op">%in%</span> <span class="va">my_vector</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Để truy vấn một giá trị <strong>không</strong> <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> một vectơ, hãy đặt dấu chấm than (!) <strong>phía trước</strong> biểu thức logic:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># to negate, put an exclamation in front</span>
<span class="op">!</span><span class="st">"a"</span> <span class="op">%in%</span> <span class="va">my_vector</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">!</span><span class="st">"h"</span> <span class="op">%in%</span> <span class="va">my_vector</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> sẽ rất hữu dụng khi dùng hàm <code>case_when()</code> của package <strong>dplyr</strong>. Bạn có thể định nghĩa một vectơ trước đó, sau đó tham chiếu đến nó. ví dụ:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">affirmative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"Yes"</span>, <span class="st">"YES"</span>, <span class="st">"yes"</span>, <span class="st">"y"</span>, <span class="st">"Y"</span>, <span class="st">"oui"</span>, <span class="st">"Oui"</span>, <span class="st">"Si"</span><span class="op">)</span>

<span class="va">linelist</span> <span class="op">&lt;-</span> <span class="va">linelist</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>child_hospitaled <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
    <span class="va">hospitalized</span> <span class="op">%in%</span> <span class="va">affirmative</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span> <span class="op">~</span> <span class="st">"Hospitalized Child"</span>,
    <span class="cn">TRUE</span>                                      <span class="op">~</span> <span class="st">"Not"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Lưu ý: Nếu bạn muốn phát hiện một phần của chuỗi, có lẽ việc sử dụng hàm <code>str_detect()</code> từ package <strong>stringr</strong>, sẽ không chấp nhận một vectơ ký tự kiểu như <code><a href="https://rdrr.io/r/base/c.html">c("1", "Yes", "yes", "y")</a></code>. Thay vào đó, nó cần được cung cấp dưới dạng một <em>biểu thức chính quy</em> - một chuối cô đọng với thanh dọc cho phép so sánh OR, chẳng hạn như “1|Yes|yes|y”. Ví dụ, <code>str_detect(hospitalized, "1|Yes|yes|y")</code>. Xem thêm chương <a href="characters-strings.html#characters-strings">Ký tự và chuỗi</a> để biết thêm chi tiết.</p>
<p>Bạn có thể chuyển đổi một vectơ ký tự thành một biểu thức chính quy được đặt tên bằng lệnh này:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">affirmative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"Yes"</span>, <span class="st">"YES"</span>, <span class="st">"yes"</span>, <span class="st">"y"</span>, <span class="st">"Y"</span>, <span class="st">"oui"</span>, <span class="st">"Oui"</span>, <span class="st">"Si"</span><span class="op">)</span>
<span class="va">affirmative</span></code></pre></div>
<pre><code>## [1] "1"   "Yes" "YES" "yes" "y"   "Y"   "oui" "Oui" "Si"</code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># condense to </span>
<span class="va">affirmative_str_search</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">affirmative</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>  <span class="co"># option with base R</span>
<span class="va">affirmative_str_search</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">affirmative</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>   <span class="co"># option with stringr package</span>

<span class="va">affirmative_str_search</span></code></pre></div>
<pre><code>## [1] "1|Yes|YES|yes|y|Y|oui|Oui|Si"</code></pre>
<!-- ======================================================= -->
<!-- ======================================================= -->
<!-- ======================================================= -->
</div>
</div>
<div id="lỗi-và-cảnh-báo" class="section level2" number="3.13">
<h2>
<span class="header-section-number">3.13</span> Lỗi và cảnh báo<a class="anchor" aria-label="anchor" href="#l%E1%BB%97i-v%C3%A0-c%E1%BA%A3nh-b%C3%A1o"><i class="fas fa-link"></i></a>
</h2>
<p>Phần này giải thích:</p>
<ul>
<li>Sự khác biệt giữa lỗi và cảnh báo<br>
</li>
<li>Mẹo cú pháp chung để viết code R<br>
</li>
<li>Trợ giúp viết code</li>
</ul>
<p>Các lỗi thường gặp và cảnh báo cũng như mẹo khắc phục sự cố có thể được tìm thấy trong chương <a href="errors.html#c%C3%A1c-l%E1%BB%97i-th%C6%B0%E1%BB%9Dng-g%E1%BA%B7p">Các lỗi thường gặp</a>.</p>
<!-- ======================================================= -->
<div id="lỗi-và-cảnh-báo-1" class="section level3 unnumbered">
<h3>Lỗi và Cảnh báo<a class="anchor" aria-label="anchor" href="#l%E1%BB%97i-v%C3%A0-c%E1%BA%A3nh-b%C3%A1o-1"><i class="fas fa-link"></i></a>
</h3>
<p>Khi một lệnh được thực thi, cửa sổ R Console có thể hiển thị cho bạn cảnh báo hoặc thông báo lỗi bằng văn bản màu đỏ.</p>
<ul>
<li><p>Một <strong>cảnh báo</strong> nghĩa là R đã hoàn thành lệnh của bạn, nhưng phải thực hiện các bước bổ sung hoặc tạo ra kết quả bất thường mà bạn cần lưu ý.</p></li>
<li><p>Một <strong>lỗi</strong> nghĩa là R không thể hoàn thành lệnh của bạn.</p></li>
</ul>
<p>Tìm manh mối:</p>
<ul>
<li><p>Thông báo lỗi/cảnh báo thường sẽ bao gồm số dòng xảy ra sự cố.</p></li>
<li><p>Nếu một đối tượng “không xác định được (is unknown)” hoặc “không tìm thấy (not found)”, có lẽ bạn đã viết sai chính tả, quên gọi một package bằng hàm library(), hoặc quên chạy lại tập lệnh của bạn sau khi thực hiện các thay đổi.</p></li>
</ul>
<p>Nếu vẫn thất bại, hãy sao chép thông báo lỗi vào Google cùng với một số từ khóa chính - rất có thể ai đó cũng đã gặp lỗi này rồi!</p>
<!-- ======================================================= -->
</div>
<div id="mẹo-cú-pháp-chung" class="section level3 unnumbered">
<h3>Mẹo cú pháp chung<a class="anchor" aria-label="anchor" href="#m%E1%BA%B9o-c%C3%BA-ph%C3%A1p-chung"><i class="fas fa-link"></i></a>
</h3>
<p>Một số điều cần nhớ khi viết lệnh trong R, để tránh lỗi và cảnh báo:</p>
<ul>
<li>Luôn đóng dấu ngoặc đơn - mẹo: đếm số lần mở dấu ngoặc đơn “(” và đóng dấu ngoặc đơn “)” cho mỗi đoạn mã</li>
<li>Tránh để khoảng trắng trong tên cột và đối tượng. Thay vào đó, hãy sử dụng dấu gạch dưới (_) hoặc dấu chấm (.)</li>
<li>Theo dõi và nhớ tách các đối số của hàm bằng dấu phẩy</li>
<li>R phân biệt chữ hoa và chữ thường, nghĩa là <code>Variable_A</code> <em>khác</em> với <code>variable_A</code>
</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="trợ-giúp-viết-code" class="section level3 unnumbered">
<h3>Trợ giúp viết code<a class="anchor" aria-label="anchor" href="#tr%E1%BB%A3-gi%C3%BAp-vi%E1%BA%BFt-code"><i class="fas fa-link"></i></a>
</h3>
<p>Bất kỳ tập lệnh nào (RMarkdown hoặc những cái khác) sẽ cung cấp manh mối khi bạn mắc lỗi. Ví dụ: nếu bạn quên viết dấu phẩy ở vị trí cần thiết hoặc quên đóng dấu ngoặc đơn, RStudio sẽ treo cờ trên dòng đó, ở phía bên trái của script, để cảnh báo bạn.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data-used.html"><span class="header-section-number">2</span> Tải sách và dữ liệu</a></div>
<div class="next"><a href="transition-to-R.html"><span class="header-section-number">4</span> Chuyển đổi sang R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basics"><span class="header-section-number">3</span> R Cơ bản</a></li>
<li><a class="nav-link" href="#t%E1%BA%A1i-sao-s%E1%BB%AD-d%E1%BB%A5ng-r"><span class="header-section-number">3.1</span> Tại sao sử dụng R?</a></li>
<li><a class="nav-link" href="#c%C3%A1c-thu%E1%BA%ADt-ng%E1%BB%AF-ch%C3%ADnh"><span class="header-section-number">3.2</span> Các thuật ngữ chính</a></li>
<li>
<a class="nav-link" href="#learning"><span class="header-section-number">3.3</span> Tài nguyên học liệu</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#t%C3%A0i-nguy%C3%AAn-trong-rstudio">Tài nguyên trong RStudio</a></li>
<li><a class="nav-link" href="#cheatsheets">Cheatsheets</a></li>
<li><a class="nav-link" href="#twitter">Twitter</a></li>
<li><a class="nav-link" href="#ngu%E1%BB%93n-t%C3%A0i-nguy%C3%AAn-tr%E1%BB%B1c-tuy%E1%BA%BFn-mi%E1%BB%85n-ph%C3%AD">Nguồn tài nguyên trực tuyến miễn phí</a></li>
<li><a class="nav-link" href="#c%C3%A1c-ng%C3%B4n-ng%E1%BB%AF-kh%C3%A1c-ngo%C3%A0i-ti%E1%BA%BFng-anh">Các ngôn ngữ khác ngoài Tiếng Anh</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#c%C3%A0i-%C4%91%E1%BA%B7t"><span class="header-section-number">3.4</span> Cài đặt</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-v%C3%A0-rstudio">R và RStudio</a></li>
<li><a class="nav-link" href="#nh%E1%BB%AFng-ph%E1%BA%A7n-m%E1%BB%81m-kh%C3%A1c-b%E1%BA%A1n-c%C3%B3-th%E1%BB%83-c%E1%BA%A7n-c%C3%A0i-%C4%91%E1%BA%B7t">Những phần mềm khác bạn có thể cần cài đặt</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#rstudio"><span class="header-section-number">3.5</span> RStudio</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#l%C3%A0m-quen">Làm quen</a></li>
<li><a class="nav-link" href="#c%C3%A1c-c%C3%A0i-%C4%91%E1%BA%B7t-c%E1%BB%A7a-rstudio">Các cài đặt của RStudio</a></li>
<li><a class="nav-link" href="#c%C3%A1c-ph%C3%ADm-t%E1%BA%AFt">Các phím tắt</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#functions"><span class="header-section-number">3.6</span> Hàm</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#c%C3%A1c-h%C3%A0m-c%C6%A1-b%E1%BA%A3n">Các hàm cơ bản</a></li>
<li><a class="nav-link" href="#h%C3%A0m-v%E1%BB%9Bi-nhi%E1%BB%81u-%C4%91%E1%BB%91i-s%E1%BB%91">Hàm với nhiều đối số</a></li>
<li><a class="nav-link" href="#vi%E1%BA%BFt-h%C3%A0m">Viết hàm</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#packages"><span class="header-section-number">3.7</span> Packages</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#c%C3%A0i-%C4%91%E1%BA%B7t-v%C3%A0-g%E1%BB%8Di">Cài đặt và Gọi</a></li>
<li><a class="nav-link" href="#c%C3%BA-ph%C3%A1p-code">Cú pháp code</a></li>
<li><a class="nav-link" href="#tr%E1%BB%A3-gi%C3%BAp-v%E1%BB%81-h%C3%A0m">Trợ giúp về hàm</a></li>
<li><a class="nav-link" href="#c%E1%BA%ADp-nh%E1%BA%ADt-packages">Cập nhật packages</a></li>
<li><a class="nav-link" href="#x%C3%B3a-packages">Xóa packages</a></li>
<li><a class="nav-link" href="#s%E1%BB%B1-ph%E1%BB%A5-thu%E1%BB%99c">Sự phụ thuộc</a></li>
<li><a class="nav-link" href="#h%C3%A0m-b%E1%BB%8B-che-gi%E1%BA%A5u">Hàm bị che giấu</a></li>
<li><a class="nav-link" href="#g%E1%BB%A1-package">Gỡ package</a></li>
<li><a class="nav-link" href="#c%C3%A0i-%C4%91%E1%BA%B7t-phi%C3%AAn-b%E1%BA%A3n-c%C5%A9-h%C6%A1n">Cài đặt phiên bản cũ hơn</a></li>
<li><a class="nav-link" href="#packages-%C4%91%E1%BB%81-xu%E1%BA%A5t">Packages đề xuất</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#scripts"><span class="header-section-number">3.8</span> Scripts</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#b%C3%ACnh-lu%E1%BA%ADn">Bình luận</a></li>
<li><a class="nav-link" href="#phong-c%C3%A1ch-vi%E1%BA%BFt-code-1">Phong cách viết code</a></li>
<li><a class="nav-link" href="#v%C3%AD-d%E1%BB%A5-v%E1%BB%81-script">Ví dụ về Script</a></li>
<li><a class="nav-link" href="#r-markdown">R markdown</a></li>
<li><a class="nav-link" href="#r-notebooks">R notebooks</a></li>
<li><a class="nav-link" href="#shiny">Shiny</a></li>
<li><a class="nav-link" href="#thu-g%E1%BB%8Dn-code">Thu gọn Code</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#th%C6%B0-m%E1%BB%A5c-l%C3%A0m-vi%E1%BB%87c"><span class="header-section-number">3.9</span> Thư mục làm việc</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#g%E1%BB%A3i-%C3%BD-c%C3%A1ch-ti%E1%BA%BFp-c%E1%BA%ADn">Gợi ý cách tiếp cận</a></li>
<li><a class="nav-link" href="#thi%E1%BA%BFt-l%E1%BA%ADp-b%E1%BA%B1ng-l%E1%BB%87nh">Thiết lập bằng lệnh</a></li>
<li><a class="nav-link" href="#thi%E1%BA%BFt-l%E1%BA%ADp-th%E1%BB%A7-c%C3%B4ng">Thiết lập thủ công</a></li>
<li><a class="nav-link" href="#thi%E1%BA%BFt-l%E1%BA%ADp-b%C3%AAn-trong-m%E1%BB%99t-d%E1%BB%B1-%C3%A1n-r">Thiết lập bên trong một dự án R</a></li>
<li><a class="nav-link" href="#th%C6%B0-m%E1%BB%A5c-l%C3%A0m-vi%E1%BB%87c-v%E1%BB%9Bi-r-markdown">Thư mục làm việc với R markdown</a></li>
<li><a class="nav-link" href="#cung-c%E1%BA%A5p-%C4%91%C6%B0%E1%BB%9Dng-d%E1%BA%ABn-t%E1%BB%87p">Cung cấp đường dẫn tệp</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#objects"><span class="header-section-number">3.10</span> Đối tượng</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#m%E1%BB%8Di-th%E1%BB%A9-%C4%91%E1%BB%81u-l%C3%A0-m%E1%BB%99t-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng">Mọi thứ đều là một đối tượng</a></li>
<li><a class="nav-link" href="#%C4%91%E1%BB%8Bnh-ngh%C4%A9a-m%E1%BB%99t-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng--">Định nghĩa một đối tượng (&lt;-)</a></li>
<li><a class="nav-link" href="#objectstructure"><span class="header-section-number">3.10.1</span> Cấu trúc đối tượng</a></li>
<li><a class="nav-link" href="#ki%E1%BB%83u-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng">Kiểu đối tượng</a></li>
<li><a class="nav-link" href="#c%E1%BB%99t-bi%E1%BA%BFn-s%E1%BB%91">Cột / Biến số ($)</a></li>
<li><a class="nav-link" href="#truy-c%E1%BA%ADp-indexing-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-b%E1%BA%B1ng-d%E1%BA%A5u-ngo%E1%BA%B7c-vu%C3%B4ng">Truy cập / indexing đối tượng bằng dấu ngoặc vuông ([ ])</a></li>
<li><a class="nav-link" href="#x%C3%B3a-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng">Xóa đối tượng</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#piping"><span class="header-section-number">3.11</span> Piping (%&gt;%)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pipes">Pipes</a></li>
<li><a class="nav-link" href="#%C4%91%E1%BB%8Bnh-ngh%C4%A9a-%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-trung-gian">Định nghĩa đối tượng trung gian</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#operators"><span class="header-section-number">3.12</span> Các toán tử và hàm chính</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#to%C3%A1n-t%E1%BB%AD-g%C3%A1n">Toán tử gán</a></li>
<li><a class="nav-link" href="#to%C3%A1n-t%E1%BB%AD-quan-h%E1%BB%87-v%C3%A0-logic">Toán tử quan hệ và logic</a></li>
<li><a class="nav-link" href="#gi%C3%A1-tr%E1%BB%8B-missing">Giá trị Missing</a></li>
<li><a class="nav-link" href="#to%C3%A1n-h%E1%BB%8Dc-v%C3%A0-th%E1%BB%91ng-k%C3%AA"><span class="header-section-number">3.12.1</span> Toán học và thống kê</a></li>
<li><a class="nav-link" href="#in">%in%</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#l%E1%BB%97i-v%C3%A0-c%E1%BA%A3nh-b%C3%A1o"><span class="header-section-number">3.13</span> Lỗi và cảnh báo</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#l%E1%BB%97i-v%C3%A0-c%E1%BA%A3nh-b%C3%A1o-1">Lỗi và Cảnh báo</a></li>
<li><a class="nav-link" href="#m%E1%BA%B9o-c%C3%BA-ph%C3%A1p-chung">Mẹo cú pháp chung</a></li>
<li><a class="nav-link" href="#tr%E1%BB%A3-gi%C3%BAp-vi%E1%BA%BFt-code">Trợ giúp viết code</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Cẩm nang dịch tễ học với R</strong>" was written by the handbook team. It was last built on 2021-09-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
